import{r as h,j as e}from"./ui-DbSH5uIw.js";import{ad as de,u as M,ao as oe,ap as ce,a as G,_ as L,c as v,T as ee,z as me,aq as xe,N as U,K as H,ar as he,C as p,q as V,aj as T,O,a0 as P,as as E,n as $,B as m,L as z,V as Y,at as F,ai as W,o as B,E as K,au as Q,av as X,Z,aw as ue,D as ge,d as pe,J as be,e as fe,f as je,ac as ve}from"./index-C3yA2dmm.js";import{A as Ne,a as we,b as ye,c as ke,d as Se,e as Ae,f as _e,g as De,h as Ce}from"./alert-dialog-D8ssqHVu.js";import{C as I,P as Pe}from"./payment-form-3Jnm-XG2.js";import{R as $e}from"./dashboard-skeleton-qKk3-62f.js";import{U as Le}from"./upload-BKlhm6vz.js";import"./vendor-15WF5uYg.js";import"./query-C11-Me4M.js";import"./charts-DfbWf95P.js";import"./checkbox-DOjwYwUo.js";import"./eye-off-Bubmbnfp.js";const Ee=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],Fe=de("calendar-clock",Ee);function Re(){const{user:l}=M(),[c,x]=h.useState([]),[d,N]=h.useState(!1);return h.useEffect(()=>{if(!l){const r=JSON.parse(localStorage.getItem("choiceProperties_applications")||"[]");x(r);return}(async()=>{N(!0);try{const r=await oe(l.id);x(r)}catch{const j=JSON.parse(localStorage.getItem("choiceProperties_applications")||"[]");x(j)}finally{N(!1)}})()},[l]),{applications:c,submitApplication:async f=>{if(!l){const r=JSON.parse(localStorage.getItem("choiceProperties_applications")||"[]"),j={id:`app_${Date.now()}`,...f,status:"pending",property_id:f.property_id},k=[...r,j];return localStorage.setItem("choiceProperties_applications",JSON.stringify(k)),x(k),j}try{const r=await ce({...f,user_id:l.id});return r&&x([...c,r]),r}catch{return null}},loading:d}}function qe(){const{user:l}=M(),{toast:c}=G(),[x,d]=h.useState([]),[N,w]=h.useState(!1),[f,r]=h.useState(null);return h.useEffect(()=>{if(!l){d([]);return}(async()=>{w(!0),r(null);try{const o=await L(),i=await fetch(`/api/saved-searches/user/${l.id}`,{headers:{Authorization:o?`Bearer ${o}`:""}});if(!i.ok)throw new Error("Failed to fetch saved searches");const n=await i.json(),a=n.data||n.searches||[];d(a)}catch(o){const i=o instanceof Error?o.message:"Error fetching searches";r(i),d([])}finally{w(!1)}})()},[l]),{searches:x,loading:N,error:f,createSearch:async(u,o)=>{if(!l)return c({title:"Sign in Required",description:"Please sign in to save searches",variant:"destructive"}),null;try{const i=await L(),n=await fetch("/api/saved-searches",{method:"POST",headers:{"Content-Type":"application/json",Authorization:i?`Bearer ${i}`:""},body:JSON.stringify({userId:l.id,name:u,filters:o})});if(!n.ok)throw new Error("Failed to save search");const a=await n.json(),S=a.data||a;return d([...x,S]),c({title:"Success",description:"Search saved successfully"}),S}catch(i){const n=i instanceof Error?i.message:"Error saving search";return r(n),c({title:"Error",description:n,variant:"destructive"}),null}},deleteSearch:async u=>{if(!l)return c({title:"Sign in Required",description:"Please sign in to delete searches",variant:"destructive"}),!1;try{const o=await L();if(!(await fetch(`/api/saved-searches/${u}`,{method:"DELETE",headers:{Authorization:o?`Bearer ${o}`:""}})).ok)throw new Error("Failed to delete search");return d(x.filter(n=>n.id!==u)),c({title:"Success",description:"Search deleted"}),!0}catch(o){const i=o instanceof Error?o.message:"Error deleting search";return r(i),c({title:"Error",description:i,variant:"destructive"}),!1}},updateSearch:async(u,o,i)=>{if(!l){const n=x.map(a=>a.id===u?{...a,name:o,filters:i,updatedAt:new Date().toISOString()}:a);return localStorage.setItem("choiceProperties_savedSearches",JSON.stringify(n)),d(n),c({title:"Success",description:"Search updated"}),n.find(a=>a.id===u)||null}try{const n=await L(),a=await fetch(`/api/saved-searches/${u}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:n?`Bearer ${n}`:""},body:JSON.stringify({name:o,filters:i})});if(!a.ok)throw new Error("Failed to update search");const S=await a.json(),_=S.data||S,R=x.map(D=>D.id===u?_:D);return d(R),c({title:"Success",description:"Search updated"}),_}catch(n){const a=n instanceof Error?n.message:"Error updating search";return r(a),c({title:"Error",description:a,variant:"destructive"}),null}}}}function Te({title:l="Are you sure?",description:c,onConfirm:x,trigger:d,variant:N="destructive",confirmText:w="Delete",cancelText:f="Cancel"}){const[r,j]=h.useState(!1),[k,A]=h.useState(!1),u=async()=>{A(!0);try{await x()}finally{A(!1),j(!1)}};return e.jsxs(Ne,{open:r,onOpenChange:j,children:[e.jsx(we,{asChild:!0,children:d||e.jsx(v,{size:"icon",variant:"ghost","data-testid":"button-delete-trigger",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(ye,{"data-testid":"dialog-confirm",children:[e.jsxs(ke,{children:[e.jsx(Se,{"data-testid":"text-dialog-title",children:l}),e.jsx(Ae,{"data-testid":"text-dialog-description",children:c})]}),e.jsxs(_e,{className:"gap-2",children:[e.jsx(De,{disabled:k,"data-testid":"button-dialog-cancel",children:f}),e.jsx(Ce,{onClick:o=>{o.preventDefault(),u()},disabled:k,className:N==="destructive"?"bg-destructive text-destructive-foreground hover:bg-destructive/90":"","data-testid":"button-dialog-confirm",children:k?"Processing...":w})]})]})]})}function Ke(){const{user:l,logout:c,isLoggedIn:x}=M(),[,d]=me(),{toast:N}=G(),[w,f]=h.useState("applications"),[r,j]=h.useState([]),[k,A]=h.useState(!1),[u,o]=h.useState(!1),[i,n]=h.useState(null),{applications:a,loading:S}=Re(),{favorites:_,toggleFavorite:R,loading:D}=xe(),{searches:q,loading:J,deleteSearch:te}=qe();if(h.useEffect(()=>{if(_.length===0){j([]);return}(async()=>{A(!0);try{const s=[];for(const g of _){const C=await fetch(`/api/v2/properties/${g}`);if(C.ok){const b=await C.json();s.push(b.data||b)}}j(s)}catch(s){console.error("Failed to fetch favorite details:",s)}finally{A(!1)}})()},[_]),!x||!l||l.role!=="renter")return d("/login"),null;if(S||D||J)return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(U,{}),e.jsx("div",{className:"bg-gradient-to-r from-primary to-secondary text-white py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("h1",{className:"text-4xl font-bold",children:"Renter Dashboard"}),e.jsx("p",{className:"text-primary-foreground/80 mt-2",children:"Manage your applications and favorites"})]})}),e.jsx($e,{}),e.jsx(H,{})]});const se=async t=>{await te(t)&&N({title:"Deleted",description:"Saved search removed"})},ae=async t=>{await R(t),N({title:"Removed",description:"Property removed from favorites"})},re=t=>{switch(t){case"approved":return e.jsx($,{className:"h-5 w-5 text-green-600 dark:text-green-400"});case"conditional_approval":return e.jsx(W,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"});case"pending":case"submitted":case"under_review":return e.jsx(B,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"});case"info_requested":return e.jsx(T,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"});case"rejected":return e.jsx(ve,{className:"h-5 w-5 text-red-600 dark:text-red-400"});default:return e.jsx(B,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}},ie=t=>{const s={pending:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 border border-blue-300 dark:border-blue-700",submitted:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 border border-blue-300 dark:border-blue-700",under_review:"bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 border border-indigo-300 dark:border-indigo-700",info_requested:"bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-200 border border-amber-300 dark:border-amber-700",conditional_approval:"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 border border-yellow-300 dark:border-yellow-700",approved:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 border border-green-300 dark:border-green-700",rejected:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 border border-red-300 dark:border-red-700"};return s[t]||s.pending},ne=t=>({pending:"Pending Review",submitted:"Submitted",under_review:"Under Review",info_requested:"Info Requested",conditional_approval:"Conditionally Approved",approved:"Approved",rejected:"Rejected"})[t]||t.replace(/_/g," ").replace(/\b\w/g,g=>g.toUpperCase()),y={applications:a.length,approved:a.filter(t=>t.status==="approved").length,pending:a.filter(t=>t.status==="pending").length,favorites:r.length,savedSearches:q.length,memberSince:l?.created_at?new Date(l.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short"}):new Date().toLocaleDateString("en-US",{year:"numeric",month:"short"})},le=[{id:"applications",label:"My Applications",icon:O,count:y.applications},{id:"favorites",label:"Saved Properties",icon:P,count:y.favorites},{id:"searches",label:"Saved Searches",icon:E,count:y.savedSearches}];return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(U,{}),e.jsx("div",{className:"bg-gradient-to-br from-blue-600 via-blue-500 to-indigo-600 text-white py-16",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-2",children:"Renter Dashboard"}),e.jsxs("p",{className:"text-blue-100 text-lg",children:["Welcome back, ",e.jsx("span",{className:"font-semibold",children:l?.email?.split("@")[0]}),"!"]})]}),e.jsxs(v,{onClick:()=>{c(),d("/")},variant:"ghost",className:"text-white hover:bg-white/20 border border-white/30","data-testid":"button-logout",children:[e.jsx(he,{className:"h-5 w-5 mr-2"}),"Sign Out"]})]})})}),(()=>{const t=a.filter(b=>b.payment_status==="pending"||b.payment_status==="failed"),s=a.filter(b=>b.status==="info_requested"),g=a.filter(b=>b.status==="conditional_approval");return t.length>0||s.length>0||g.length>0?e.jsx("div",{className:"container mx-auto px-4 -mt-8 relative z-20 mb-4","data-testid":"alerts-banner",children:e.jsx(p,{className:"border-l-4 border-l-amber-500 bg-amber-50 dark:bg-amber-900/20",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(V,{className:"h-5 w-5 text-amber-600 dark:text-amber-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-amber-800 dark:text-amber-200",children:"Action Required"}),e.jsxs("div",{className:"mt-2 space-y-1 text-sm text-amber-700 dark:text-amber-300",children:[t.length>0&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),t.length," application",t.length>1?"s":""," need",t.length===1?"s":""," payment"]}),s.length>0&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),s.length," application",s.length>1?"s":""," need",s.length===1?"s":""," additional information"]}),g.length>0&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),g.length," conditional approval",g.length>1?"s":""," await",g.length===1?"s":""," documents"]})]})]}),e.jsx(v,{size:"sm",variant:"outline",onClick:()=>f("applications"),className:"border-amber-400 text-amber-700 hover:bg-amber-100 dark:border-amber-600 dark:text-amber-300 dark:hover:bg-amber-800/30","data-testid":"button-view-alerts",children:"View Details"})]})})})}):null})(),e.jsx("div",{className:"container mx-auto px-4 -mt-10 relative z-10 mb-12",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5",children:[e.jsx(p,{className:"p-6 hover:shadow-lg transition-all duration-300 border border-border hover:border-blue-300 dark:hover:border-blue-700","data-testid":"stat-applications",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Applications"}),e.jsx("p",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400 mt-2",children:y.applications}),e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mt-2 font-medium",children:[y.approved," approved â€¢ ",y.pending," pending"]})]}),e.jsx(O,{className:"h-8 w-8 text-blue-200 dark:text-blue-800 flex-shrink-0"})]})}),e.jsx(p,{className:"p-6 hover:shadow-lg transition-all duration-300 border border-border hover:border-red-300 dark:hover:border-red-700","data-testid":"stat-favorites",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Saved Properties"}),e.jsx("p",{className:"text-4xl font-bold text-red-600 dark:text-red-400 mt-2",children:y.favorites}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[y.favorites===1?"property":"properties"," in wishlist"]})]}),e.jsx(P,{className:"h-8 w-8 text-red-200 dark:text-red-800 flex-shrink-0 fill-current"})]})}),e.jsx(p,{className:"p-6 hover:shadow-lg transition-all duration-300 border border-border hover:border-indigo-300 dark:hover:border-indigo-700","data-testid":"stat-searches",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Saved Searches"}),e.jsx("p",{className:"text-4xl font-bold text-indigo-600 dark:text-indigo-400 mt-2",children:y.savedSearches}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Quick access to filters"})]}),e.jsx(E,{className:"h-8 w-8 text-indigo-200 dark:text-indigo-800 flex-shrink-0"})]})}),e.jsx(p,{className:"p-6 hover:shadow-lg transition-all duration-300 border border-border hover:border-emerald-300 dark:hover:border-emerald-700","data-testid":"stat-member-since",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wide",children:"Member Since"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-600 dark:text-emerald-400 mt-2",children:y.memberSince}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Active member"})]}),e.jsx($,{className:"h-8 w-8 text-emerald-200 dark:text-emerald-800 flex-shrink-0"})]})})]})}),e.jsxs("div",{className:"container mx-auto px-4 flex-1 pb-12",children:[e.jsx("div",{className:"flex gap-1 mb-8 border-b border-border overflow-x-auto -mx-4 px-4",children:le.map(t=>e.jsxs("button",{onClick:()=>f(t.id),className:`px-4 py-3 font-semibold text-sm transition-all duration-200 border-b-2 flex items-center gap-2 whitespace-nowrap relative group ${w===t.id?"border-b-blue-600 text-blue-600 dark:text-blue-400":"border-b-transparent text-muted-foreground hover:text-foreground"}`,"data-testid":`tab-${t.id}`,children:[e.jsx(t.icon,{className:"h-4 w-4"}),e.jsx("span",{children:t.label}),t.count>0&&e.jsx(m,{variant:"secondary",className:"ml-1 text-xs","data-testid":`tab-count-${t.id}`,children:t.count})]},t.id))}),w==="applications"&&e.jsx("div",{className:"space-y-4","data-testid":"section-applications",children:S?e.jsxs(p,{className:"p-16 text-center",children:[e.jsx(z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4 animate-spin"}),e.jsx("p",{className:"text-foreground font-semibold",children:"Loading your applications..."}),e.jsx("p",{className:"text-muted-foreground text-sm mt-2",children:"This should only take a moment"})]}):a.length===0?e.jsxs(p,{className:"p-16 text-center",children:[e.jsx(O,{className:"h-16 w-16 text-muted-foreground/40 mx-auto mb-6"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:"No Applications Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-sm mx-auto",children:"Start your rental journey by applying to properties that catch your eye."}),e.jsxs(v,{onClick:()=>d("/properties"),className:"bg-blue-600 hover:bg-blue-700","data-testid":"button-browse-properties",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Browse Properties"]})]}):e.jsx("div",{className:"space-y-4",children:a.map(t=>e.jsx(p,{className:"p-6 hover:shadow-md transition-all duration-200 border-l-4 border-l-blue-500 hover:border-l-blue-600","data-testid":`card-application-${t.id}`,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[re(t.status),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-bold text-foreground truncate",children:t.property?.title||`Application #${t.id.slice(0,8)}`}),t.property?.address&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1 mt-1",children:[e.jsx(F,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("span",{className:"truncate",children:[t.property.address,", ",t.property.city,", ",t.property.state]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-3",children:[e.jsx(m,{className:ie(t.status),children:ne(t.status)}),t.payment_status==="paid"?e.jsxs(m,{className:"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 border border-green-300 dark:border-green-700",children:[e.jsx($,{className:"h-3 w-3 mr-1"}),"Fee Paid"]}):t.payment_status==="failed"?e.jsxs(m,{className:"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 border border-red-300 dark:border-red-700",children:[e.jsx(V,{className:"h-3 w-3 mr-1"}),"Payment Failed"]}):e.jsxs(m,{className:"bg-amber-100 dark:bg-amber-900 text-amber-800 dark:text-amber-200 border border-amber-300 dark:border-amber-700",children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),"Fee Pending"]}),t.created_at&&e.jsxs("span",{className:"text-xs text-muted-foreground font-medium",children:["Applied ",new Date(t.created_at).toLocaleDateString()]})]}),Array.isArray(t.payment_attempts)&&t.payment_attempts.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-muted/30 rounded-lg",children:[e.jsxs("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:["Payment Attempts (",t.payment_attempts.length,")"]}),e.jsx("div",{className:"space-y-1 max-h-20 overflow-y-auto",children:t.payment_attempts.slice(-3).map((s,g)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground font-mono",children:s.referenceId||"N/A"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:s.timestamp?new Date(s.timestamp).toLocaleDateString():"N/A"}),e.jsx(m,{variant:s.status==="success"?"default":"destructive",className:"text-xs",children:s.status==="success"?"Paid":"Failed"})]})]},g))})]}),t.status==="conditional_approval"&&e.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg","data-testid":`conditional-requirements-${t.id}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(W,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"}),e.jsx("h4",{className:"font-semibold text-yellow-800 dark:text-yellow-200",children:"Conditionally Approved"})]}),t.conditional_approval_reason&&e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mb-3",children:t.conditional_approval_reason}),t.conditional_approval_due_date&&e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-sm text-yellow-700 dark:text-yellow-300",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsxs("span",{children:["Due by: ",new Date(t.conditional_approval_due_date).toLocaleDateString()]})]}),Array.isArray(t.conditional_requirements)&&t.conditional_requirements.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-yellow-700 dark:text-yellow-300 uppercase tracking-wide",children:"Requirements to Complete:"}),t.conditional_requirements.map(s=>e.jsxs("div",{className:"flex items-start gap-2 p-2 bg-white dark:bg-gray-800 rounded border border-yellow-200 dark:border-yellow-700",children:[s.satisfied?e.jsx($,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}):e.jsx(B,{className:"h-4 w-4 text-amber-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(m,{variant:"outline",className:"text-xs",children:s.type}),s.required&&!s.satisfied&&e.jsx(m,{variant:"outline",className:"text-xs text-red-600 border-red-300",children:"Required"}),s.satisfied&&e.jsx(m,{className:"text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 border border-green-300 dark:border-green-700",children:"Complete"})]}),e.jsx("p",{className:"text-sm mt-1",children:s.description})]})]},s.id))]})]}),t.status==="info_requested"&&e.jsxs("div",{className:"mt-4 p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg","data-testid":`info-requested-${t.id}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{className:"h-5 w-5 text-amber-600 dark:text-amber-400"}),e.jsx("h4",{className:"font-semibold text-amber-800 dark:text-amber-200",children:"Additional Information Requested"})]}),t.info_requested_reason&&e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:t.info_requested_reason}),e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400 mt-2",children:"Please contact the landlord or respond to their message to provide the requested information."})]}),t.status==="approved"&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg","data-testid":`approved-steps-${t.id}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx($,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),e.jsx("h4",{className:"font-semibold text-green-800 dark:text-green-200",children:"Congratulations! Application Approved"})]}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300 mb-3",children:"Your application has been approved. Here are the next steps:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center text-xs font-medium text-green-700 dark:text-green-300",children:"1"}),e.jsx("span",{className:"text-green-700 dark:text-green-300",children:"Wait for lease agreement"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center text-xs font-medium text-green-700 dark:text-green-300",children:"2"}),e.jsx("span",{className:"text-green-700 dark:text-green-300",children:"Sign the lease document"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center text-xs font-medium text-green-700 dark:text-green-300",children:"3"}),e.jsx("span",{className:"text-green-700 dark:text-green-300",children:"Schedule move-in date"})]})]}),t.lease_status&&e.jsx("div",{className:"mt-3 pt-3 border-t border-green-200 dark:border-green-700",children:e.jsxs("p",{className:"text-xs font-medium text-green-700 dark:text-green-300",children:["Lease Status: ",e.jsx(m,{variant:"outline",className:"ml-1 text-green-600 border-green-400",children:t.lease_status.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase())})]})})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 flex-shrink-0",children:[t.property_id&&e.jsxs(v,{size:"sm",variant:"outline",onClick:()=>d(`/property/${t.property_id}`),"data-testid":`button-view-property-${t.id}`,children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),"View"]}),t.payment_status!=="paid"&&e.jsxs(v,{size:"sm",variant:"default",onClick:()=>{n(t),o(!0)},"data-testid":`button-pay-fee-${t.id}`,children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),t.payment_status==="failed"?"Retry Payment":"Pay Fee"]})]})]})},t.id))})}),w==="favorites"&&e.jsx("div",{className:"space-y-6","data-testid":"section-favorites",children:k||D?e.jsxs(p,{className:"p-16 text-center",children:[e.jsx(z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4 animate-spin"}),e.jsx("p",{className:"text-foreground font-semibold",children:"Loading saved properties..."})]}):r.length===0?e.jsxs(p,{className:"p-16 text-center",children:[e.jsx(P,{className:"h-16 w-16 text-muted-foreground/40 mx-auto mb-6"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:"No Saved Properties Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-sm mx-auto",children:"Heart your favorite properties to save them here for easy access."}),e.jsxs(v,{onClick:()=>d("/properties"),className:"bg-blue-600 hover:bg-blue-700","data-testid":"button-explore-properties",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Explore Properties"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(t=>e.jsxs(p,{className:"overflow-hidden hover:shadow-xl transition-all duration-300 hover:scale-105","data-testid":`card-property-${t.id}`,children:[e.jsxs("div",{className:"relative aspect-video bg-gradient-to-br from-slate-200 to-slate-300 dark:from-slate-700 dark:to-slate-800 overflow-hidden",children:[t.images?.[0]?e.jsx("img",{src:t.images[0],alt:t.title,className:"w-full h-full object-cover hover:scale-110 transition-transform duration-300"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(F,{className:"h-8 w-8 text-muted-foreground opacity-50"})}),e.jsx("button",{onClick:()=>ae(t.id),className:"absolute top-3 right-3 bg-white dark:bg-slate-900 rounded-full p-2 shadow-lg hover:shadow-xl transition-all","data-testid":`button-unfavorite-${t.id}`,children:e.jsx(P,{className:"h-5 w-5 text-red-500 fill-red-500"})}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx(m,{className:"bg-blue-600 text-white",children:t.property_type||"Property"})})]}),e.jsxs("div",{className:"p-5",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-2 mb-2",children:t.title}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1 mb-4",children:[e.jsx(F,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("span",{className:"line-clamp-1",children:[t.city,", ",t.state]})]}),e.jsxs("div",{className:"flex gap-4 text-sm mb-4 pb-4 border-b border-border",children:[e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",children:[e.jsx(Q,{className:"h-4 w-4"}),t.bedrooms," bed"]}),e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",children:[e.jsx(X,{className:"h-4 w-4"}),t.bathrooms," bath"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"font-bold text-lg text-foreground",children:(t.price||0).toLocaleString()})]}),e.jsxs(v,{size:"sm",variant:"outline",onClick:()=>d(`/property/${t.id}`),"data-testid":`button-view-property-${t.id}`,children:["View",e.jsx(Y,{className:"h-3 w-3 ml-1"})]})]})]})]},t.id))})}),w==="searches"&&e.jsx("div",{className:"space-y-4","data-testid":"section-searches",children:J?e.jsxs(p,{className:"p-16 text-center",children:[e.jsx(z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4 animate-spin"}),e.jsx("p",{className:"text-foreground font-semibold",children:"Loading saved searches..."})]}):q.length===0?e.jsxs(p,{className:"p-16 text-center",children:[e.jsx(E,{className:"h-16 w-16 text-muted-foreground/40 mx-auto mb-6"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:"No Saved Searches Yet"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-sm mx-auto",children:"Save your search filters to quickly revisit them anytime."}),e.jsxs(v,{onClick:()=>d("/properties"),className:"bg-blue-600 hover:bg-blue-700","data-testid":"button-create-search",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Start Searching"]})]}):e.jsx("div",{className:"space-y-4",children:q.map((t,s)=>e.jsx(p,{className:"p-6 hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-700","data-testid":`card-search-${t.id}`,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-foreground mb-3",children:t.name||`Search ${s+1}`}),t.filters&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.filters.city&&e.jsxs(m,{variant:"secondary",className:"flex items-center gap-1","data-testid":`badge-city-${t.id}`,children:[e.jsx(F,{className:"h-3 w-3"}),t.filters.city]}),t.filters.minPrice&&e.jsxs(m,{variant:"secondary",className:"flex items-center gap-1","data-testid":`badge-price-${t.id}`,children:[e.jsx(Z,{className:"h-3 w-3"}),"$",t.filters.minPrice?.toLocaleString()," - $",t.filters.maxPrice?.toLocaleString()]}),t.filters.bedrooms&&e.jsxs(m,{variant:"secondary",className:"flex items-center gap-1","data-testid":`badge-beds-${t.id}`,children:[e.jsx(Q,{className:"h-3 w-3"}),t.filters.bedrooms,"+ Beds"]}),t.filters.bathrooms&&e.jsxs(m,{variant:"secondary",className:"flex items-center gap-1","data-testid":`badge-baths-${t.id}`,children:[e.jsx(X,{className:"h-3 w-3"}),t.filters.bathrooms,"+ Baths"]}),t.filters.propertyType&&e.jsxs(m,{variant:"secondary",className:"flex items-center gap-1","data-testid":`badge-type-${t.id}`,children:[e.jsx(ue,{className:"h-3 w-3"}),t.filters.propertyType]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-3",children:["Saved ",new Date(t.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>{const g=new URLSearchParams;Object.entries(t.filters||{}).forEach(([C,b])=>{b&&g.append(C,String(b))}),d(`/properties?${g.toString()}`)},"data-testid":`button-view-results-${t.id}`,children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),"View Results"]}),e.jsx(Te,{title:"Delete Saved Search",description:"Are you sure you want to delete this saved search? This action cannot be undone.",onConfirm:()=>se(t.id),trigger:e.jsx(v,{variant:"ghost",size:"sm","data-testid":`button-delete-search-${t.id}`,children:e.jsx(ee,{className:"h-4 w-4"})})})]})]})},t.id))})})]}),e.jsx(ge,{open:u,onOpenChange:o,children:e.jsxs(pe,{className:"sm:max-w-lg",children:[e.jsxs(be,{children:[e.jsx(fe,{children:"Application Processing Fee"}),e.jsx(je,{children:"Pay the application fee to expedite your application review."})]}),i&&e.jsx(Pe,{amount:i.application_fee||50,propertyAddress:i.property?.address,applicationId:i.id,onError:t=>{N({title:"Payment Failed",description:t,variant:"destructive"})}})]})}),e.jsx(H,{})]})}export{Ke as default};
