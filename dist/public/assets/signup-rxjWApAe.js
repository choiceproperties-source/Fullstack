import{r as h,j as e}from"./ui-DbSH5uIw.js";import{a as G,y as H,u as O,z as Y,N as K,C as W,p as Q,I as g,M as X,P as q,a1 as ee,aa as se,U as te,c as A,v as T,E as F,ab as I,ac as L,Y as P,K as ae}from"./index-C3yA2dmm.js";import{C as re}from"./checkbox-DOjwYwUo.js";import{u as oe}from"./forms-DE5E1-IR.js";import{t as ne,b as le,s as M,e as ie}from"./types-CF7YDNpg.js";import{s as ce}from"./schema-CGOlytRX.js";import{F as de,a as l,b as i,c,d,e as m}from"./form-Dx3lF8C4.js";import{m as f}from"./proxy-BJuH2pIT.js";import{U as me}from"./user-plus-BnoYiih0.js";import{A as xe}from"./index-BQMeD4bJ.js";import{B as pe}from"./briefcase-EFKpiKWl.js";import{E as $}from"./eye-off-Bubmbnfp.js";import"./vendor-15WF5uYg.js";import"./query-C11-Me4M.js";import"./charts-DfbWf95P.js";const ue=[{value:"renter",label:"Renter",description:"Looking to rent a property",icon:ee},{value:"landlord",label:"Landlord",description:"Individual property owner",icon:se},{value:"property_manager",label:"Property Manager",description:"Manage multiple properties",icon:te},{value:"agent",label:"Real Estate Agent",description:"Licensed agent",icon:pe}],he=ce.extend({phone:M().optional(),role:ie(["renter","landlord","property_manager","agent"]),confirmPassword:M().min(1,"Please confirm your password"),agreeToTerms:le().refine(t=>t===!0,{message:"You must agree to the terms and privacy policy"})}).refine(t=>t.password===t.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),fe=[{label:"At least 8 characters",test:t=>t.length>=8},{label:"One uppercase letter",test:t=>/[A-Z]/.test(t)},{label:"One number",test:t=>/[0-9]/.test(t)},{label:"One special character",test:t=>/[^A-Za-z0-9]/.test(t)}],ge=t=>{let n=0;return t.length>=8&&n++,t.length>=12&&n++,/[A-Z]/.test(t)&&n++,/[0-9]/.test(t)&&n++,/[^A-Za-z0-9]/.test(t)&&n++,n},je=t=>t===0?{label:"Very weak",color:"bg-red-500"}:t===1?{label:"Weak",color:"bg-red-500"}:t===2?{label:"Fair",color:"bg-yellow-500"}:t===3?{label:"Good",color:"bg-yellow-500"}:t===4?{label:"Strong",color:"bg-green-500"}:{label:"Very strong",color:"bg-green-500"};function $e(){const{toast:t}=G();h.useEffect(()=>{H({title:"Sign Up - Choice Properties",description:"Create your Choice Properties account. Browse rentals, apply for properties, and find your perfect home.",image:"https://choiceproperties.com/og-image.png",url:"https://choiceproperties.com/signup"})},[]);const{signup:n}=O(),[,D]=Y(),[o,k]=h.useState(!1),[j,R]=h.useState(!1),[b,U]=h.useState(!1),[y,S]=h.useState(1),N="signup_step1_data",w=(()=>{try{const s=localStorage.getItem(N);if(s){const a=JSON.parse(s);return{email:a.email||"",fullName:a.fullName||"",phone:a.phone||"",role:a.role||"renter"}}}catch{localStorage.removeItem(N)}return null})(),r=oe({resolver:ne(he),defaultValues:{email:w?.email||"",fullName:w?.fullName||"",phone:w?.phone||"",role:w?.role||"renter",password:"",confirmPassword:"",agreeToTerms:!1}}),x=r.watch("password"),C=r.watch("confirmPassword"),v=h.useMemo(()=>ge(x),[x]),E=je(v),_=x&&C&&x===C,B=()=>{const s=r.getValues(),a={email:s.email,fullName:s.fullName,phone:s.phone,role:s.role};localStorage.setItem(N,JSON.stringify(a))},V=()=>{localStorage.removeItem(N)},J=s=>{const a=s.toLowerCase();if(a.includes("email")&&(a.includes("exists")||a.includes("duplicate")||a.includes("already"))){r.setError("email",{message:"An account with this email already exists. Please sign in instead."}),S(1);return}if(a.includes("password")){r.setError("password",{message:s});return}r.setError("root",{message:s})},Z=async s=>{k(!0);try{await n(s.email,s.fullName,s.password,s.phone,s.role),V(),t({title:"Account created!",description:"Please check your email to verify your account."}),D("/verify-email")}catch(a){J(a.message||"Signup failed. Please try again.")}finally{k(!1)}},z=async()=>{await r.trigger(["fullName","email","phone","role"])&&(B(),S(2))};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(K,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4 bg-gradient-to-br from-primary/5 via-background to-secondary/5",children:e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"w-full max-w-md",children:e.jsxs(W,{className:"w-full p-8 shadow-xl border-t-4 border-t-primary",children:[e.jsx("div",{className:"text-center mb-6",children:e.jsxs(f.div,{initial:{scale:.9},animate:{scale:1},transition:{duration:.3,delay:.1},children:[e.jsx("div",{className:"w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(me,{className:"h-7 w-7 text-primary"})}),e.jsx("h2",{className:"text-3xl font-bold text-foreground mb-1",children:"Create Account"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Join Choice Properties and find your perfect home"})]})}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:`flex-1 h-1 rounded-full transition-colors ${y>=1?"bg-primary":"bg-muted"}`}),e.jsx("div",{className:`flex-1 h-1 rounded-full transition-colors ${y>=2?"bg-primary":"bg-muted"}`})]}),e.jsx(de,{...r,children:e.jsx("form",{onSubmit:r.handleSubmit(Z),className:"space-y-4",children:e.jsxs(xe,{mode:"wait",children:[y===1&&e.jsxs(f.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.2},className:"space-y-4",children:[e.jsx(l,{control:r.control,name:"fullName",render:({field:s})=>e.jsxs(i,{children:[e.jsxs(c,{className:"font-medium text-sm flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"})," Full Name"]}),e.jsx(d,{children:e.jsx(g,{type:"text",placeholder:"John Doe",disabled:o,autoComplete:"name","data-testid":"input-fullname",className:"h-11",...s})}),e.jsx(m,{})]})}),e.jsx(l,{control:r.control,name:"email",render:({field:s})=>e.jsxs(i,{children:[e.jsxs(c,{className:"font-medium text-sm flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-muted-foreground"})," Email"]}),e.jsx(d,{children:e.jsx(g,{type:"email",placeholder:"you@example.com",disabled:o,autoComplete:"email","data-testid":"input-email",className:"h-11",...s})}),e.jsx(m,{})]})}),e.jsx(l,{control:r.control,name:"phone",render:({field:s})=>e.jsxs(i,{children:[e.jsxs(c,{className:"font-medium text-sm flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-muted-foreground"})," Phone",e.jsx("span",{className:"text-muted-foreground font-normal",children:"(optional)"})]}),e.jsx(d,{children:e.jsx(g,{type:"tel",placeholder:"+1 (555) 123-4567",disabled:o,autoComplete:"tel","data-testid":"input-phone",className:"h-11",...s})}),e.jsx(m,{})]})}),e.jsx(l,{control:r.control,name:"role",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{className:"font-medium text-sm",children:"I am a..."}),e.jsx(d,{children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ue.map(a=>{const p=a.icon,u=s.value===a.value;return e.jsxs("button",{type:"button",onClick:()=>s.onChange(a.value),disabled:o,"data-testid":`button-role-${a.value}`,className:`p-3 rounded-md border text-left transition-all ${u?"border-primary bg-primary/10 ring-1 ring-primary":"border-border hover:border-primary/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:`h-4 w-4 ${u?"text-primary":"text-muted-foreground"}`}),e.jsx("span",{className:`text-sm font-medium ${u?"text-primary":""}`,children:a.label})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a.description})]},a.value)})})}),e.jsx(m,{})]})}),r.formState.errors.root&&e.jsx(f.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-600 text-sm bg-red-50 dark:bg-red-950/50 p-3 rounded-md","data-testid":"text-error",children:r.formState.errors.root.message}),e.jsx(A,{type:"button",onClick:z,className:"w-full h-11",disabled:o,"data-testid":"button-continue",children:"Continue"})]},"step1"),y===2&&e.jsxs(f.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},className:"space-y-4",children:[e.jsx("button",{type:"button",onClick:()=>S(1),className:"text-sm text-muted-foreground hover:text-foreground transition-colors mb-2 flex items-center gap-1","data-testid":"button-back",children:e.jsx("span",{children:"Back to details"})}),e.jsx(l,{control:r.control,name:"password",render:({field:s})=>e.jsxs(i,{children:[e.jsxs(c,{className:"font-medium text-sm flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 text-muted-foreground"})," Password"]}),e.jsx(d,{children:e.jsxs("div",{className:"relative",children:[e.jsx(g,{type:j?"text":"password",placeholder:"Create a strong password",disabled:o,autoComplete:"new-password","data-testid":"input-password",className:"h-11 pr-10",...s}),e.jsx("button",{type:"button",onClick:()=>R(!j),disabled:o,className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors","data-testid":"button-toggle-password","aria-label":j?"Hide password":"Show password",children:j?e.jsx($,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"})})]})}),x&&e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsx("div",{className:"flex gap-1",children:[...Array(5)].map((a,p)=>e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors ${p<v?E.color:"bg-muted"}`},p))}),e.jsx("p",{className:`text-xs font-medium ${v<=1?"text-red-500":v<=3?"text-yellow-600":"text-green-600"}`,children:E.label}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:fe.map((a,p)=>{const u=a.test(x);return e.jsxs("div",{className:"flex items-center gap-2",children:[u?e.jsx(I,{className:"h-3.5 w-3.5 text-green-500"}):e.jsx(L,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:`text-xs ${u?"text-green-600":"text-muted-foreground"}`,children:a.label})]},p)})})]}),e.jsx(m,{})]})}),e.jsx(l,{control:r.control,name:"confirmPassword",render:({field:s})=>e.jsxs(i,{children:[e.jsxs(c,{className:"font-medium text-sm flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4 text-muted-foreground"})," Confirm Password"]}),e.jsx(d,{children:e.jsxs("div",{className:"relative",children:[e.jsx(g,{type:b?"text":"password",placeholder:"Confirm your password",disabled:o,autoComplete:"new-password","data-testid":"input-confirm-password",className:"h-11 pr-10",...s}),e.jsx("button",{type:"button",onClick:()=>U(!b),disabled:o,className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors","data-testid":"button-toggle-confirm-password","aria-label":b?"Hide password":"Show password",children:b?e.jsx($,{className:"h-4 w-4"}):e.jsx(F,{className:"h-4 w-4"})})]})}),C&&e.jsx("div",{className:"flex items-center gap-2 mt-2",children:_?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-3.5 w-3.5 text-green-500"}),e.jsx("span",{className:"text-xs text-green-600",children:"Passwords match"})]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-3.5 w-3.5 text-red-500"}),e.jsx("span",{className:"text-xs text-red-500",children:"Passwords don't match"})]})}),e.jsx(m,{})]})}),e.jsx(l,{control:r.control,name:"agreeToTerms",render:({field:s})=>e.jsxs(i,{className:"flex items-start gap-3 space-y-0 pt-2",children:[e.jsx(d,{children:e.jsx(re,{checked:s.value,onCheckedChange:s.onChange,disabled:o,"data-testid":"checkbox-terms",className:"mt-0.5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs(c,{className:"text-sm font-normal text-muted-foreground leading-relaxed cursor-pointer",children:["I agree to the"," ",e.jsx(P,{href:"/terms",children:e.jsx("span",{className:"text-primary hover:underline",children:"Terms of Service"})})," ","and"," ",e.jsx(P,{href:"/privacy",children:e.jsx("span",{className:"text-primary hover:underline",children:"Privacy Policy"})})]}),e.jsx(m,{})]})]})}),r.formState.errors.root&&e.jsx(f.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-600 text-sm bg-red-50 dark:bg-red-950/50 p-3 rounded-md","data-testid":"text-error",children:r.formState.errors.root.message}),e.jsx(A,{type:"submit",className:"w-full h-11",disabled:o,"data-testid":"button-create-account",children:o?"Creating Account...":"Create Account"})]},"step2")]})})}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground mt-6",children:["Already have an account?"," ",e.jsx(P,{href:"/login",children:e.jsx("span",{className:"text-primary font-semibold cursor-pointer hover:underline","data-testid":"link-login",children:"Sign in"})})]})]})})}),e.jsx(ae,{})]})}export{$e as default};
