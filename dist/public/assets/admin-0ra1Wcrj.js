import{r as t,j as e}from"./ui-DbSH5uIw.js";import{ad as pe,u as tt,a as at,z as it,aM as lt,aN as rt,aO as nt,aP as dt,ao as ct,aQ as ot,aR as xt,aS as mt,aT as ht,aU as ut,aV as pt,C as d,w as De,Y as jt,c as r,aW as gt,ar as Ye,U as We,a1 as Pe,O as he,aj as ue,as as Ge,ai as ft,aX as vt,ay as Nt,aA as yt,B as c,l as m,F as y,G as w,n as _e,H as T,E as A,ab as Je,S as D,g as P,aw as Ue,h as _,i as U,j as i,aD as Qe,T as Re,X as h,I as p,at as wt,al as bt,o as St,m as Ze,M as kt,P as Ct,aY as es,D as V,d as O,J as E,e as H,f as $e,Q as At,k as Fe,ac as Dt,aZ as Pt,a_ as _t,a$ as Ut,b0 as Rt,b1 as $t,b2 as Ft,b3 as Lt,b4 as qt,b5 as It}from"./index-C3yA2dmm.js";import{A as Tt,b as Mt,c as zt,d as Vt,e as Ot,f as Et,g as Ht,h as Bt}from"./alert-dialog-D8ssqHVu.js";import{R as Z,P as Le,a as qe,C as Ie,T as ee,B as Kt,b as ss,X as ts,Y as as,d as Xt,L as Yt,e as Wt,f as Gt}from"./charts-DfbWf95P.js";import{P as Jt}from"./pen-BEjIonrQ.js";import{F as is}from"./file-check-Dbb_BHol.js";import"./vendor-15WF5uYg.js";import"./query-C11-Me4M.js";const Qt=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Zt=pe("chart-column",Qt);const ea=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],ls=pe("flag",ea);const sa=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],ta=pe("layout-dashboard",sa);const aa=[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ia=pe("user-cog",aa);function Ia(){const{user:M,logout:rs}=tt(),{toast:x}=at(),[,ns]=it(),[C,Te]=t.useState(!0),[b,ds]=t.useState("dashboard"),[Me,ze]=t.useState(!0),[B,cs]=t.useState([]),[R,os]=t.useState([]),[se,xs]=t.useState([]),[$,ms]=t.useState([]),[v,hs]=t.useState([]),[te,us]=t.useState([]),[la,ps]=t.useState([]),[ra,js]=t.useState({}),[Y,gs]=t.useState([]),[W,fs]=t.useState([]),[G,vs]=t.useState([]),[Ns,ae]=t.useState(!1),[ys,ie]=t.useState(!1),[ws,Ve]=t.useState(!1),[bs,le]=t.useState(!1),[na,da]=t.useState(!1),[Ss,re]=t.useState(!1),[ks,je]=t.useState(!1),[Cs,Oe]=t.useState(!1),[ca,oa]=t.useState(!1),[xa,ma]=t.useState(!1),[ha,ua]=t.useState(null),[pa,ja]=t.useState({fullName:"",email:"",displayEmail:"",displayPhone:"",role:"agent",bio:"",location:""}),[ga,fa]=t.useState({}),[F,z]=t.useState(null),[g,ge]=t.useState(null),[va,Na]=t.useState(null),[l,Ee]=t.useState(null),[N,As]=t.useState(null),[K,Ds]=t.useState(null),[ya,Ps]=t.useState(null),[wa,_s]=t.useState(null),[ba,Us]=t.useState(null),[Sa,Rs]=t.useState(!1),[ka,$s]=t.useState(!1),[Ca,Fs]=t.useState(!1),[X,fe]=t.useState("reports"),[j,J]=t.useState({status:"all",city:"",minPrice:"",maxPrice:""}),[ne,Ls]=t.useState("all"),[de,qs]=t.useState(""),[ve,Is]=t.useState("newest"),[ce,Ts]=t.useState("all"),[oe,Ms]=t.useState("all"),[o,S]=t.useState({title:"",price:"",address:"",city:"",state:"",bedrooms:"",bathrooms:"",property_type:"house",description:""}),[L,xe]=t.useState({email:"",full_name:"",role:"user"}),[f,q]=t.useState({}),[Aa,Da]=t.useState({});t.useEffect(()=>{k()},[]);const k=async()=>{Te(!0);try{const[s,a,u,I,Ce,Ae,Js,Qs,Zs,et,st]=await Promise.all([lt(),rt(),nt(),dt(),ct(),ot(),xt(),mt(),ht(),ut(),pt()]);cs(s),os(a),xs(u),ms(I||[]),hs(Ce||[]),us(Ae||[]),ps(Js||[]),js(Qs||{}),gs(Zs||[]),fs(et||[]),vs(st||[])}catch{x({title:"Failed to load data",variant:"destructive"})}finally{Te(!1)}};if(!M||M.role!=="admin")return e.jsx("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center p-4",children:e.jsxs(d,{className:"p-8 max-w-md w-full text-center",children:[e.jsx(De,{className:"h-12 w-12 mx-auto text-destructive mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"You don't have permission to access the admin panel."}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Admin access requires the 'admin' role."}),e.jsx(jt,{href:"/",children:e.jsx(r,{className:"w-full","data-testid":"button-go-home",children:"Go to Home"})})]})});const Q=v.filter(s=>s.score!==void 0&&s.score!==null),zs=Q.filter(s=>(s.score||0)>=70),Ne=v.filter(s=>s.status==="pending"&&(s.score||0)>=70),Vs=v.filter(s=>s.status==="under_review"),n={totalProperties:B.length,activeProperties:B.filter(s=>s.status==="active").length,totalUsers:R.length,renters:R.filter(s=>s.role==="renter"||s.role==="user").length,owners:R.filter(s=>s.role==="owner").length,agents:R.filter(s=>s.role==="agent").length,admins:R.filter(s=>s.role==="admin").length,totalReviews:se.length,avgRating:se.length>0?(se.reduce((s,a)=>s+a.rating,0)/se.length).toFixed(1):"0",totalApplications:v.length,pendingApplications:v.filter(s=>s.status==="pending").length,underReviewApplications:Vs.length,approvedApplications:v.filter(s=>s.status==="approved").length,rejectedApplications:v.filter(s=>s.status==="rejected").length,scoredApplications:Q.length,avgScore:Q.length>0?Math.round(Q.reduce((s,a)=>s+(a.score||0),0)/Q.length):0,highScoreCount:zs.length,pendingHighScoreCount:Ne.length,totalInquiries:$.length,pendingInquiries:$.filter(s=>s.status==="pending").length,totalSavedSearches:te.length},ye=t.useMemo(()=>B.filter(s=>!(j.status!=="all"&&s.status!==j.status||j.city&&!s.city?.toLowerCase().includes(j.city.toLowerCase())||j.minPrice&&s.price<parseFloat(j.minPrice)||j.maxPrice&&s.price>parseFloat(j.maxPrice))),[B,j]),we=t.useMemo(()=>{let s=v;if(ne!=="all"&&(s=s.filter(a=>a.status===ne)),de.trim()){const a=de.toLowerCase().trim();s=s.filter(u=>u.users?.full_name?.toLowerCase().includes(a)||u.properties?.title?.toLowerCase().includes(a)||u.id.toLowerCase().includes(a))}return[...s].sort((a,u)=>{switch(ve){case"newest":return new Date(u.created_at).getTime()-new Date(a.created_at).getTime();case"oldest":return new Date(a.created_at).getTime()-new Date(u.created_at).getTime();default:return 0}})},[v,ne,de,ve]),be=t.useMemo(()=>ce==="all"?R:R.filter(s=>s.role===ce),[R,ce]),Se=t.useMemo(()=>oe==="all"?$:$.filter(s=>s.status===oe),[$,oe]),me=[{name:"Renters",value:n.renters,fill:"hsl(var(--primary))"},{name:"Owners",value:n.owners,fill:"hsl(var(--chart-2))"},{name:"Agents",value:n.agents,fill:"hsl(var(--chart-3))"},{name:"Admins",value:n.admins,fill:"hsl(var(--chart-4))"}].filter(s=>s.value>0),He=[{name:"Pending",value:n.pendingApplications,fill:"hsl(45 93% 47%)"},{name:"Approved",value:n.approvedApplications,fill:"hsl(142 76% 36%)"},{name:"Rejected",value:n.rejectedApplications,fill:"hsl(0 84% 60%)"}].filter(s=>s.value>0),Os=t.useMemo(()=>{const s={};return v.forEach(a=>{const u=a.property_id||"Unknown";s[u]=(s[u]||0)+1}),B.slice(0,10).map(a=>({name:a.title?.substring(0,15)||"Unknown",applications:s[a.id]||0}))},[v,B]),Es=t.useMemo(()=>{const s=[];for(let a=6;a>=0;a--){const u=new Date;u.setDate(u.getDate()-a);const I=u.toISOString().split("T")[0],Ce=$.filter(Ae=>Ae.created_at?.startsWith(I)).length;s.push({date:u.toLocaleDateString("en-US",{weekday:"short"}),count:Ce})}return s},[$]),Hs=async()=>{if(!M?.id||!o.title||!o.address){x({title:"Please fill in required fields",variant:"destructive"});return}M.id,o.title,o.description,o.address,o.city,o.state,parseFloat(o.price),parseInt(o.bedrooms),parseFloat(o.bathrooms),o.property_type,await Pt()?(x({title:"Property created successfully"}),ae(!1),S({title:"",price:"",address:"",city:"",state:"",bedrooms:"",bathrooms:"",property_type:"house",description:""}),k()):x({title:"Failed to create property",variant:"destructive"})},Bs=async()=>{if(!g?.id)return;const s={};for(const[u,I]of Object.entries(f))I!=null&&I!==""&&(s[u]=I);if(Object.keys(s).length===0){x({title:"No changes to update",variant:"destructive"});return}await _t(g.id)?(x({title:"Property updated successfully"}),ie(!1),ge(null),q({}),k()):x({title:"Failed to update property",variant:"destructive"})},Ks=async s=>{await Ut()?(x({title:"Property deleted"}),z(null),k()):x({title:"Failed to delete property",variant:"destructive"})},Xs=async()=>{if(!L.email||!L.full_name){x({title:"Please fill in all fields",variant:"destructive"});return}await Rt()?(x({title:"User created successfully"}),le(!1),xe({email:"",full_name:"",role:"user"}),k()):x({title:"Failed to create user",variant:"destructive"})},Ys=async s=>{await $t()?(x({title:"User deleted"}),z(null),k()):x({title:"Failed to delete user",variant:"destructive"})},Ws=async(s,a)=>{await Ft()?(x({title:`User role updated to ${a}`}),k()):x({title:"Failed to update user role",variant:"destructive"})},ke=async(s,a)=>{await Lt()?(x({title:`Application ${a}`}),re(!1),k()):x({title:"Failed to update application",variant:"destructive"})},Be=async(s,a)=>{await qt()?(x({title:`Inquiry ${a}`}),je(!1),k()):x({title:"Failed to update inquiry",variant:"destructive"})},Gs=async s=>{await It()?(x({title:"Saved search deleted"}),z(null),k()):x({title:"Failed to delete saved search",variant:"destructive"})},Ke=async()=>{try{await rs(),ns("/")}catch{x({title:"Logout failed",variant:"destructive"})}},Xe=[{id:"dashboard",label:"Dashboard",icon:ta},{id:"users",label:"Users",icon:We},{id:"properties",label:"Properties",icon:Pe},{id:"applications",label:"Applications",icon:he},{id:"inquiries",label:"Inquiries",icon:ue},{id:"saved-searches",label:"Saved Searches",icon:Ge},{id:"personas",label:"Personas",icon:ia},{id:"moderation",label:"Moderation",icon:ft},{id:"settings",label:"Settings",icon:vt},{id:"analytics",label:"Analytics",icon:Zt}];return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col lg:flex-row",children:[e.jsx("header",{className:"lg:hidden bg-background border-b sticky top-0 z-40",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 p-4",children:[e.jsx(r,{variant:"ghost",size:"icon",onClick:()=>ze(!Me),"data-testid":"button-sidebar-toggle",children:e.jsx(gt,{className:"h-5 w-5"})}),e.jsx("h1",{className:"font-bold text-lg",children:"Admin Panel"}),e.jsx(r,{variant:"ghost",size:"icon",onClick:Ke,"data-testid":"button-logout",children:e.jsx(Ye,{className:"h-5 w-5"})})]})}),e.jsx("aside",{className:`${Me?"block":"hidden"} lg:block w-full lg:w-64 bg-card border-r fixed lg:static top-16 lg:top-0 left-0 right-0 lg:h-screen overflow-y-auto z-30`,children:e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsx("div",{className:"hidden lg:block",children:e.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5"}),"Admin"]})}),e.jsx("nav",{className:"space-y-2",children:Xe.map(s=>{const a=s.icon;return e.jsxs("button",{onClick:()=>{ds(s.id),ze(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-md transition-colors ${b===s.id?"bg-primary text-primary-foreground":"hover:bg-muted"}`,"data-testid":`nav-${s.id}`,children:[e.jsx(a,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:s.label})]},s.id)})}),e.jsx("hr",{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Nt,{className:"h-8 w-8",children:e.jsx(yt,{children:M?.full_name?.[0]?.toUpperCase()||"A"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate","data-testid":"text-admin-name",children:M?.full_name||"Admin"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:M?.email})]})]}),e.jsxs(r,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:Ke,"data-testid":"button-logout-sidebar",children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]})}),e.jsxs("main",{className:"flex-1 overflow-auto pb-20 lg:pb-0",children:[e.jsx("div",{className:"hidden lg:block bg-gradient-to-r from-primary to-primary/80 text-primary-foreground py-6 sticky top-0 z-10",children:e.jsxs("div",{className:"px-8 flex justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold capitalize","data-testid":"text-section-title",children:Xe.find(s=>s.id===b)?.label||"Dashboard"}),e.jsx("p",{className:"text-primary-foreground/80 text-sm",children:"Manage your platform"})]}),e.jsxs(c,{className:"bg-primary-foreground/20",children:[e.jsx(De,{className:"h-3 w-3 mr-1"}),"Admin Access"]})]})}),e.jsxs("div",{className:"p-4 lg:p-8 space-y-6",children:[C&&e.jsx("p",{className:"text-muted-foreground","data-testid":"text-loading",children:"Loading data..."}),b==="dashboard"&&!C&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(Pe,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Properties"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"stat-properties",children:n.totalProperties}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.activeProperties," active"]})]})]})})}),e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(We,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Users"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"stat-users",children:n.totalUsers}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.agents," agents"]})]})]})})}),e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-lg",children:e.jsx(he,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Applications"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"stat-applications",children:n.totalApplications}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.pendingApplications," pending"]})]})]})})}),e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/10 rounded-lg",children:e.jsx(ue,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Inquiries"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"stat-inquiries",children:n.totalInquiries}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.pendingInquiries," pending"]})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(d,{children:[e.jsx(y,{children:e.jsx(w,{className:"text-lg",children:"Users by Role"})}),e.jsx(m,{children:e.jsx(Z,{width:"100%",height:250,children:e.jsxs(Le,{children:[e.jsx(qe,{data:me,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:s,value:a})=>`${s}: ${a}`,children:me.map((s,a)=>e.jsx(Ie,{fill:s.fill},`cell-${a}`))}),e.jsx(ee,{})]})})})]}),e.jsxs(d,{children:[e.jsx(y,{children:e.jsx(w,{className:"text-lg",children:"Application Status"})}),e.jsx(m,{children:e.jsx(Z,{width:"100%",height:250,children:e.jsxs(Le,{children:[e.jsx(qe,{data:He,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:s,value:a})=>`${s}: ${a}`,children:He.map((s,a)=>e.jsx(Ie,{fill:s.fill},`cell-${a}`))}),e.jsx(ee,{})]})})})]}),e.jsxs(d,{children:[e.jsx(y,{children:e.jsx(w,{className:"text-lg",children:"Application Scoring"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Scored Applications"}),e.jsx("span",{className:"font-bold","data-testid":"stat-scored",children:n.scoredApplications})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Average Score"}),e.jsxs(c,{variant:n.avgScore>=70?"default":"secondary","data-testid":"stat-avg-score",children:[n.avgScore,"/100"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"High Score (70+)"}),e.jsx("span",{className:"font-bold text-green-600","data-testid":"stat-high-score",children:n.highScoreCount})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Under Review"}),e.jsx("span",{className:"font-bold text-blue-600","data-testid":"stat-under-review",children:n.underReviewApplications})]})]})})]})]}),Ne.length>0&&e.jsxs(d,{className:"border-green-200 dark:border-green-800",children:[e.jsxs(y,{className:"pb-3",children:[e.jsxs(w,{className:"text-lg flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5 text-green-600"}),"Quick Actions: High-Scoring Pending Applications"]}),e.jsx(T,{children:"These applications have a score of 70 or higher and are awaiting review"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:Ne.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg","data-testid":`quick-action-${s.id}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:s.users?.full_name||"Applicant"}),e.jsxs(c,{variant:"outline",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:["Score: ",s.score,"/100"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.properties?.title||"Property"," - Applied ",new Date(s.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{size:"sm",variant:"outline",onClick:()=>{Ee(s),re(!0)},"data-testid":`quick-view-${s.id}`,children:[e.jsx(A,{className:"h-4 w-4 mr-1"}),"Review"]}),e.jsxs(r,{size:"sm",onClick:()=>ke(s.id,"approved"),"data-testid":`quick-approve-${s.id}`,children:[e.jsx(Je,{className:"h-4 w-4 mr-1"}),"Approve"]})]})]},s.id))})})]}),e.jsxs(d,{children:[e.jsxs(y,{children:[e.jsx(w,{className:"text-lg",children:"Recent Activity"}),e.jsx(T,{children:"Latest applications and inquiries"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-3 max-h-[250px] overflow-y-auto",children:[...v.slice(0,3).map(s=>({type:"application",data:s,date:new Date(s.created_at)})),...$.slice(0,3).map(s=>({type:"inquiry",data:s,date:new Date(s.created_at)}))].sort((s,a)=>a.date.getTime()-s.date.getTime()).slice(0,5).map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/50",children:[s.type==="application"?e.jsx(he,{className:"h-4 w-4 text-green-600"}):e.jsx(ue,{className:"h-4 w-4 text-yellow-600"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.type==="application"?`New application for ${s.data.properties?.title||"property"}`:`Inquiry from ${s.data.sender_name}`}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.date.toLocaleString()})]}),e.jsx(c,{variant:"secondary",className:"text-xs",children:(s.type==="application",s.data.status)})]},a))})})]})]}),b==="users"&&!C&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["All Users (",be.length,")"]}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs(c,{variant:"secondary",children:[n.renters," renters"]}),e.jsxs(c,{variant:"secondary",children:[n.owners," owners"]}),e.jsxs(c,{variant:"secondary",children:[n.agents," agents"]}),e.jsxs(c,{variant:"secondary",children:[n.admins," admins"]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(D,{value:ce,onValueChange:Ts,children:[e.jsxs(P,{className:"w-32","data-testid":"filter-user-role",children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),e.jsx(_,{})]}),e.jsxs(U,{children:[e.jsx(i,{value:"all",children:"All Roles"}),e.jsx(i,{value:"user",children:"User"}),e.jsx(i,{value:"renter",children:"Renter"}),e.jsx(i,{value:"owner",children:"Owner"}),e.jsx(i,{value:"agent",children:"Agent"}),e.jsx(i,{value:"admin",children:"Admin"})]})]}),e.jsxs(r,{onClick:()=>le(!0),size:"sm","data-testid":"button-add-user",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Add User"]})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Joined"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Actions"})]})}),e.jsx("tbody",{children:be.map(s=>e.jsxs("tr",{className:"border-t","data-testid":`row-user-${s.id}`,children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:s.full_name||"N/A"}),e.jsx("td",{className:"px-4 py-3",children:s.email}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(c,{variant:s.role==="admin"?"default":s.role==="agent"?"secondary":"outline",children:s.role})}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground text-xs",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{value:s.role,onValueChange:a=>Ws(s.id,a),children:[e.jsx(P,{className:"w-24 h-8","data-testid":`select-role-${s.id}`,children:e.jsx(_,{})}),e.jsxs(U,{children:[e.jsx(i,{value:"user",children:"User"}),e.jsx(i,{value:"renter",children:"Renter"}),e.jsx(i,{value:"owner",children:"Owner"}),e.jsx(i,{value:"agent",children:"Agent"}),e.jsx(i,{value:"admin",children:"Admin"})]})]}),e.jsx(r,{variant:"outline",size:"icon",onClick:()=>z({type:"user",id:s.id,name:s.full_name||s.email}),"data-testid":`button-delete-user-${s.id}`,children:e.jsx(Re,{className:"h-4 w-4 text-destructive"})})]})})]},s.id))})]}),be.length===0&&e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No users found"})]})]}),b==="properties"&&!C&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["All Properties (",ye.length,")"]}),e.jsxs(r,{onClick:()=>ae(!0),size:"sm","data-testid":"button-add-property",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Add Property"]})]}),e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(h,{className:"text-xs",children:"Status"}),e.jsxs(D,{value:j.status,onValueChange:s=>J({...j,status:s}),children:[e.jsx(P,{className:"w-32","data-testid":"filter-property-status",children:e.jsx(_,{})}),e.jsxs(U,{children:[e.jsx(i,{value:"all",children:"All"}),e.jsx(i,{value:"active",children:"Active"}),e.jsx(i,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(h,{className:"text-xs",children:"City"}),e.jsx(p,{placeholder:"Filter by city",value:j.city,onChange:s=>J({...j,city:s.target.value}),className:"w-40","data-testid":"filter-property-city"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(h,{className:"text-xs",children:"Min Price"}),e.jsx(p,{type:"number",placeholder:"Min",value:j.minPrice,onChange:s=>J({...j,minPrice:s.target.value}),className:"w-28","data-testid":"filter-property-min-price"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(h,{className:"text-xs",children:"Max Price"}),e.jsx(p,{type:"number",placeholder:"Max",value:j.maxPrice,onChange:s=>J({...j,maxPrice:s.target.value}),className:"w-28","data-testid":"filter-property-max-price"})]}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>J({status:"all",city:"",minPrice:"",maxPrice:""}),"data-testid":"button-clear-filters",children:"Clear"})]})}),e.jsxs("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:[ye.map(s=>e.jsx(d,{className:"p-4","data-testid":`card-property-${s.id}`,children:e.jsxs("div",{className:"flex justify-between items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold truncate",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(wt,{className:"h-3 w-3"}),s.address,", ",s.city]}),e.jsxs("div",{className:"flex gap-2 mt-2 flex-wrap items-center",children:[e.jsx(c,{variant:"secondary",children:s.property_type}),e.jsx(c,{variant:s.status==="active"?"default":"secondary",children:s.status}),e.jsxs("span",{className:"text-sm font-medium text-primary",children:["$",s.price?.toLocaleString()]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"outline",size:"icon",onClick:()=>{ge(s),Ve(!0)},"data-testid":`button-view-property-${s.id}`,children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx(r,{variant:"outline",size:"icon",onClick:()=>{ge(s),q(s),ie(!0)},"data-testid":`button-edit-property-${s.id}`,children:e.jsx(Jt,{className:"h-4 w-4"})}),e.jsx(r,{variant:"outline",size:"icon",onClick:()=>z({type:"property",id:s.id,name:s.title}),"data-testid":`button-delete-property-${s.id}`,children:e.jsx(Re,{className:"h-4 w-4 text-destructive"})})]})]})},s.id)),ye.length===0&&e.jsxs(d,{className:"p-8 text-center",children:[e.jsx(Pe,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No properties found"})]})]})]}),b==="applications"&&!C&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["All Applications (",we.length,")"]}),e.jsxs("div",{className:"flex gap-2 text-xs flex-wrap",children:[e.jsxs(c,{variant:"outline",className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:[n.pendingApplications," pending"]}),e.jsxs(c,{variant:"outline",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[n.approvedApplications," approved"]}),e.jsxs(c,{variant:"outline",className:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:[n.rejectedApplications," rejected"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(p,{placeholder:"Search by name or property...",value:de,onChange:s=>qs(s.target.value),className:"w-48","data-testid":"input-application-search"}),e.jsxs(D,{value:ne,onValueChange:Ls,children:[e.jsxs(P,{className:"w-40","data-testid":"filter-application-status",children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),e.jsx(_,{})]}),e.jsxs(U,{children:[e.jsx(i,{value:"all",children:"All Status"}),e.jsx(i,{value:"pending",children:"Pending"}),e.jsx(i,{value:"under_review",children:"Under Review"}),e.jsx(i,{value:"pending_verification",children:"Pending Verification"}),e.jsx(i,{value:"approved",children:"Approved"}),e.jsx(i,{value:"approved_pending_lease",children:"Approved - Pending Lease"}),e.jsx(i,{value:"rejected",children:"Rejected"}),e.jsx(i,{value:"withdrawn",children:"Withdrawn"}),e.jsx(i,{value:"expired",children:"Expired"})]})]}),e.jsxs(D,{value:ve,onValueChange:Is,children:[e.jsx(P,{className:"w-32","data-testid":"sort-applications",children:e.jsx(_,{})}),e.jsxs(U,{children:[e.jsx(i,{value:"newest",children:"Newest First"}),e.jsx(i,{value:"oldest",children:"Oldest First"})]})]})]})]}),we.length===0?e.jsxs(d,{className:"p-8 text-center",children:[e.jsx(he,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No applications found"})]}):e.jsx("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:we.map(s=>e.jsx(d,{className:"p-4","data-testid":`card-application-${s.id}`,children:e.jsxs("div",{className:"flex justify-between items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("p",{className:"font-medium",children:["Application #",s.id.slice(0,8)]}),s.score!==void 0&&s.score!==null&&e.jsxs(c,{variant:"outline",className:s.score>=70?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":s.score>=50?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200","data-testid":`score-badge-${s.id}`,children:["Score: ",s.score]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(bt,{className:"h-3 w-3"}),new Date(s.created_at).toLocaleDateString(),s.users?.full_name&&e.jsxs("span",{className:"ml-2",children:["by ",s.users.full_name]})]}),s.properties?.title&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Property: ",s.properties.title]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(c,{variant:s.status==="approved"?"default":s.status==="rejected"?"destructive":"secondary",className:s.status==="pending"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":s.status==="under_review"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"",children:[s.status==="pending"&&e.jsx(St,{className:"h-3 w-3 mr-1"}),s.status==="approved"&&e.jsx(_e,{className:"h-3 w-3 mr-1"}),s.status==="rejected"&&e.jsx(Ze,{className:"h-3 w-3 mr-1"}),s.status==="under_review"&&e.jsx(A,{className:"h-3 w-3 mr-1"}),s.status]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>{Ee(s),re(!0)},"data-testid":`button-view-application-${s.id}`,children:[e.jsx(A,{className:"h-4 w-4 mr-1"}),"View"]})]})]})},s.id))})]}),b==="inquiries"&&!C&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:["All Inquiries (",Se.length,")"]}),e.jsxs(c,{variant:"outline",className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:[n.pendingInquiries," pending"]})]}),e.jsxs(D,{value:oe,onValueChange:Ms,children:[e.jsxs(P,{className:"w-36","data-testid":"filter-inquiry-status",children:[e.jsx(Ue,{className:"h-4 w-4 mr-1"}),e.jsx(_,{})]}),e.jsxs(U,{children:[e.jsx(i,{value:"all",children:"All Status"}),e.jsx(i,{value:"pending",children:"Pending"}),e.jsx(i,{value:"responded",children:"Responded"}),e.jsx(i,{value:"closed",children:"Closed"})]})]})]}),Se.length===0?e.jsxs(d,{className:"p-8 text-center",children:[e.jsx(ue,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No inquiries found"})]}):e.jsx("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:Se.map(s=>e.jsx(d,{className:"p-4","data-testid":`card-inquiry-${s.id}`,children:e.jsxs("div",{className:"flex justify-between items-start gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.sender_name}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(kt,{className:"h-3 w-3"}),s.sender_email]}),s.sender_phone&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(Ct,{className:"h-3 w-3"}),s.sender_phone]}),e.jsx("p",{className:"text-sm mt-2 line-clamp-2",children:s.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:s.status==="closed"?"default":s.status==="responded"?"secondary":"outline",className:s.status==="pending"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"",children:s.status}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>{As(s),je(!0)},"data-testid":`button-view-inquiry-${s.id}`,children:[e.jsx(A,{className:"h-4 w-4 mr-1"}),"View"]})]})]})},s.id))})]}),b==="saved-searches"&&!C&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("h3",{className:"text-xl font-semibold",children:["Saved Searches (",te.length,")"]})}),te.length===0?e.jsxs(d,{className:"p-8 text-center",children:[e.jsx(Ge,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No saved searches yet"})]}):e.jsx("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:te.map(s=>e.jsx(d,{className:"p-4","data-testid":`card-search-${s.id}`,children:e.jsxs("div",{className:"flex justify-between items-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:s.name||"Unnamed Search"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.users?.full_name||"Unknown User"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>{Ds(s),Oe(!0)},"data-testid":`button-view-search-${s.id}`,children:[e.jsx(A,{className:"h-4 w-4 mr-1"}),"View Filters"]}),e.jsx(r,{variant:"outline",size:"icon",onClick:()=>z({type:"search",id:s.id,name:s.name||"this search"}),"data-testid":`button-delete-search-${s.id}`,children:e.jsx(Re,{className:"h-4 w-4 text-destructive"})})]})]})},s.id))})]}),b==="moderation"&&!C&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-destructive/10 rounded-lg",children:e.jsx(ls,{className:"h-6 w-6 text-destructive"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Content Reports"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"stat-reports",children:Y.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Y.filter(s=>s.status==="pending").length," pending"]})]})]})})}),e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/10 rounded-lg",children:e.jsx(es,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Disputes"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"stat-disputes",children:W.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[W.filter(s=>s.status==="open").length," open"]})]})]})})}),e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(is,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Doc Verifications"}),e.jsx("p",{className:"text-2xl font-bold","data-testid":"stat-verifications",children:G.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[G.filter(s=>s.status==="pending").length," pending"]})]})]})})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(r,{variant:X==="reports"?"default":"outline",onClick:()=>fe("reports"),"data-testid":"tab-reports",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Flagged Content (",Y.length,")"]}),e.jsxs(r,{variant:X==="disputes"?"default":"outline",onClick:()=>fe("disputes"),"data-testid":"tab-disputes",children:[e.jsx(es,{className:"h-4 w-4 mr-2"}),"Disputes (",W.length,")"]}),e.jsxs(r,{variant:X==="documents"?"default":"outline",onClick:()=>fe("documents"),"data-testid":"tab-documents",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Document Verification (",G.length,")"]})]}),X==="reports"&&e.jsxs(d,{children:[e.jsxs(y,{children:[e.jsx(w,{children:"Content Reports"}),e.jsx(T,{children:"Review flagged listings and reviews"})]}),e.jsx(m,{children:Y.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No content reports"}):e.jsx("div",{className:"space-y-3",children:Y.map(s=>e.jsxs("div",{className:"flex items-start justify-between gap-4 p-4 bg-muted/50 rounded-lg","data-testid":`report-${s.id}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(c,{variant:s.status==="pending"?"destructive":s.status==="reviewed"?"secondary":"outline",children:s.status}),e.jsx(c,{variant:"outline",children:s.report_type}),e.jsx(c,{variant:"outline",children:s.priority})]}),e.jsx("p",{className:"font-medium mt-2",children:s.property?.title||s.review?.comment?.substring(0,50)||"Unknown content"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description||"No description"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Reported by: ",s.reporter?.full_name||"Unknown"," on ",new Date(s.created_at).toLocaleDateString()]})]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>{Ps(s),Rs(!0)},"data-testid":`button-view-report-${s.id}`,children:[e.jsx(A,{className:"h-4 w-4 mr-1"}),"Review"]})]},s.id))})})]}),X==="disputes"&&e.jsxs(d,{children:[e.jsxs(y,{children:[e.jsx(w,{children:"Disputes"}),e.jsx(T,{children:"Manage user disputes and conflicts"})]}),e.jsx(m,{children:W.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No disputes"}):e.jsx("div",{className:"space-y-3",children:W.map(s=>e.jsxs("div",{className:"flex items-start justify-between gap-4 p-4 bg-muted/50 rounded-lg","data-testid":`dispute-${s.id}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(c,{variant:s.status==="open"?"destructive":s.status==="in_progress"?"secondary":"outline",children:s.status}),e.jsx(c,{variant:"outline",children:s.dispute_type}),e.jsx(c,{variant:"outline",children:s.priority})]}),e.jsx("p",{className:"font-medium mt-2",children:s.subject}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:s.description}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[s.initiator?.full_name||"Unknown"," vs ",s.respondent?.full_name||"Unknown"," | ",new Date(s.created_at).toLocaleDateString()]})]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>{_s(s),$s(!0)},"data-testid":`button-view-dispute-${s.id}`,children:[e.jsx(A,{className:"h-4 w-4 mr-1"}),"View"]})]},s.id))})})]}),X==="documents"&&e.jsxs(d,{children:[e.jsxs(y,{children:[e.jsx(w,{children:"Document Verification"}),e.jsx(T,{children:"Verify user-submitted documents"})]}),e.jsx(m,{children:G.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No documents pending verification"}):e.jsx("div",{className:"space-y-3",children:G.map(s=>e.jsxs("div",{className:"flex items-start justify-between gap-4 p-4 bg-muted/50 rounded-lg","data-testid":`document-${s.id}`,children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(c,{variant:s.status==="pending"?"secondary":s.status==="verified"?"default":"destructive",children:s.status}),e.jsx(c,{variant:"outline",children:s.document_type})]}),e.jsx("p",{className:"font-medium mt-2",children:s.file?.original_name||s.file?.filename||"Unknown file"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["User: ",s.user?.full_name||"Unknown"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Submitted: ",new Date(s.created_at).toLocaleDateString(),s.verified_at&&` | Verified: ${new Date(s.verified_at).toLocaleDateString()}`]})]}),e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>{Us(s),Fs(!0)},"data-testid":`button-view-document-${s.id}`,children:[e.jsx(A,{className:"h-4 w-4 mr-1"}),"Review"]})]},s.id))})})]})]}),b==="analytics"&&!C&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(d,{children:e.jsxs(m,{className:"pt-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Total Users"}),e.jsx("p",{className:"text-3xl font-bold","data-testid":"analytics-users",children:n.totalUsers})]})}),e.jsx(d,{children:e.jsxs(m,{className:"pt-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Total Properties"}),e.jsx("p",{className:"text-3xl font-bold","data-testid":"analytics-properties",children:n.totalProperties})]})}),e.jsx(d,{children:e.jsxs(m,{className:"pt-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Total Applications"}),e.jsx("p",{className:"text-3xl font-bold","data-testid":"analytics-applications",children:n.totalApplications})]})}),e.jsx(d,{children:e.jsxs(m,{className:"pt-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Total Inquiries"}),e.jsx("p",{className:"text-3xl font-bold","data-testid":"analytics-inquiries",children:n.totalInquiries})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(d,{children:[e.jsxs(y,{children:[e.jsx(w,{className:"text-lg",children:"Applications per Property"}),e.jsx(T,{children:"Top 10 properties by application count"})]}),e.jsx(m,{children:e.jsx(Z,{width:"100%",height:300,children:e.jsxs(Kt,{data:Os,children:[e.jsx(ss,{strokeDasharray:"3 3"}),e.jsx(ts,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:10}),e.jsx(as,{}),e.jsx(ee,{}),e.jsx(Xt,{dataKey:"applications",fill:"hsl(var(--primary))"})]})})})]}),e.jsxs(d,{children:[e.jsxs(y,{children:[e.jsx(w,{className:"text-lg",children:"Users by Role"}),e.jsx(T,{children:"Distribution of user roles"})]}),e.jsx(m,{children:e.jsx(Z,{width:"100%",height:300,children:e.jsxs(Le,{children:[e.jsx(qe,{data:me,cx:"50%",cy:"50%",outerRadius:100,dataKey:"value",label:({name:s,percent:a})=>`${s}: ${(a*100).toFixed(0)}%`,children:me.map((s,a)=>e.jsx(Ie,{fill:s.fill},`cell-${a}`))}),e.jsx(ee,{}),e.jsx(Yt,{})]})})})]})]}),e.jsxs(d,{children:[e.jsxs(y,{children:[e.jsx(w,{className:"text-lg",children:"Inquiries Over Time"}),e.jsx(T,{children:"Last 7 days"})]}),e.jsx(m,{children:e.jsx(Z,{width:"100%",height:300,children:e.jsxs(Wt,{data:Es,children:[e.jsx(ss,{strokeDasharray:"3 3"}),e.jsx(ts,{dataKey:"date"}),e.jsx(as,{}),e.jsx(ee,{}),e.jsx(Gt,{type:"monotone",dataKey:"count",stroke:"hsl(var(--primary))",strokeWidth:2,dot:{fill:"hsl(var(--primary))"}})]})})})]})]})]})]}),e.jsx(V,{open:Ns,onOpenChange:ae,children:e.jsxs(O,{className:"max-w-lg",children:[e.jsxs(E,{children:[e.jsx(H,{children:"Add New Property"}),e.jsx($e,{children:"Create a new property listing"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Title"}),e.jsx(p,{value:o.title,onChange:s=>S({...o,title:s.target.value}),"data-testid":"input-property-title"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Price"}),e.jsx(p,{type:"number",value:o.price,onChange:s=>S({...o,price:s.target.value}),"data-testid":"input-property-price"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Type"}),e.jsxs(D,{value:o.property_type,onValueChange:s=>S({...o,property_type:s}),children:[e.jsx(P,{"data-testid":"select-property-type",children:e.jsx(_,{})}),e.jsxs(U,{children:[e.jsx(i,{value:"house",children:"House"}),e.jsx(i,{value:"apartment",children:"Apartment"}),e.jsx(i,{value:"condo",children:"Condo"}),e.jsx(i,{value:"townhouse",children:"Townhouse"})]})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Address"}),e.jsx(p,{value:o.address,onChange:s=>S({...o,address:s.target.value}),"data-testid":"input-property-address"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"City"}),e.jsx(p,{value:o.city,onChange:s=>S({...o,city:s.target.value}),"data-testid":"input-property-city"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"State"}),e.jsx(p,{value:o.state,onChange:s=>S({...o,state:s.target.value}),"data-testid":"input-property-state"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Bedrooms"}),e.jsx(p,{type:"number",value:o.bedrooms,onChange:s=>S({...o,bedrooms:s.target.value}),"data-testid":"input-property-bedrooms"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Bathrooms"}),e.jsx(p,{type:"number",value:o.bathrooms,onChange:s=>S({...o,bathrooms:s.target.value}),"data-testid":"input-property-bathrooms"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Description"}),e.jsx(At,{value:o.description,onChange:s=>S({...o,description:s.target.value}),"data-testid":"input-property-description"})]})]}),e.jsxs(Fe,{children:[e.jsx(r,{variant:"outline",onClick:()=>ae(!1),children:"Cancel"}),e.jsx(r,{onClick:Hs,"data-testid":"button-save-property",children:"Create Property"})]})]})}),e.jsx(V,{open:ys,onOpenChange:ie,children:e.jsxs(O,{className:"max-w-lg",children:[e.jsxs(E,{children:[e.jsx(H,{children:"Edit Property"}),e.jsx($e,{children:"Update property details"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Title"}),e.jsx(p,{value:f.title||"",onChange:s=>q({...f,title:s.target.value}),"data-testid":"input-edit-property-title"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Price"}),e.jsx(p,{type:"number",value:f.price||"",onChange:s=>q({...f,price:parseFloat(s.target.value)}),"data-testid":"input-edit-property-price"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Status"}),e.jsxs(D,{value:f.status||"active",onValueChange:s=>q({...f,status:s}),children:[e.jsx(P,{"data-testid":"select-edit-property-status",children:e.jsx(_,{})}),e.jsxs(U,{children:[e.jsx(i,{value:"active",children:"Active"}),e.jsx(i,{value:"inactive",children:"Inactive"})]})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Address"}),e.jsx(p,{value:f.address||"",onChange:s=>q({...f,address:s.target.value}),"data-testid":"input-edit-property-address"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"City"}),e.jsx(p,{value:f.city||"",onChange:s=>q({...f,city:s.target.value}),"data-testid":"input-edit-property-city"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"State"}),e.jsx(p,{value:f.state||"",onChange:s=>q({...f,state:s.target.value}),"data-testid":"input-edit-property-state"})]})]})]}),e.jsxs(Fe,{children:[e.jsx(r,{variant:"outline",onClick:()=>ie(!1),children:"Cancel"}),e.jsx(r,{onClick:Bs,"data-testid":"button-update-property",children:"Update Property"})]})]})}),e.jsx(V,{open:ws,onOpenChange:Ve,children:e.jsxs(O,{className:"max-w-lg",children:[e.jsx(E,{children:e.jsx(H,{children:g?.title})}),g&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Price"}),e.jsxs("p",{className:"font-medium",children:["$",g.price?.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(c,{variant:g.status==="active"?"default":"secondary",children:g.status})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Address"}),e.jsxs("p",{className:"font-medium",children:[g.address,", ",g.city,", ",g.state]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Type"}),e.jsx("p",{className:"font-medium capitalize",children:g.property_type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bedrooms"}),e.jsx("p",{className:"font-medium",children:g.bedrooms})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Bathrooms"}),e.jsx("p",{className:"font-medium",children:g.bathrooms})]})]}),g.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Description"}),e.jsx("p",{className:"text-sm",children:g.description})]})]})]})}),e.jsx(V,{open:bs,onOpenChange:le,children:e.jsxs(O,{className:"max-w-md",children:[e.jsxs(E,{children:[e.jsx(H,{children:"Add New User"}),e.jsx($e,{children:"Create a new user account"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Full Name"}),e.jsx(p,{value:L.full_name,onChange:s=>xe({...L,full_name:s.target.value}),"data-testid":"input-user-name"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Email"}),e.jsx(p,{type:"email",value:L.email,onChange:s=>xe({...L,email:s.target.value}),"data-testid":"input-user-email"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(h,{children:"Role"}),e.jsxs(D,{value:L.role,onValueChange:s=>xe({...L,role:s}),children:[e.jsx(P,{"data-testid":"select-user-role",children:e.jsx(_,{})}),e.jsxs(U,{children:[e.jsx(i,{value:"user",children:"User"}),e.jsx(i,{value:"renter",children:"Renter"}),e.jsx(i,{value:"owner",children:"Owner"}),e.jsx(i,{value:"agent",children:"Agent"}),e.jsx(i,{value:"admin",children:"Admin"})]})]})]})]}),e.jsxs(Fe,{children:[e.jsx(r,{variant:"outline",onClick:()=>le(!1),children:"Cancel"}),e.jsx(r,{onClick:Xs,"data-testid":"button-save-user",children:"Create User"})]})]})}),e.jsx(V,{open:Ss,onOpenChange:re,children:e.jsxs(O,{className:"max-w-lg max-h-[80vh] overflow-y-auto",children:[e.jsx(E,{children:e.jsx(H,{children:"Application Details"})}),l&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Application ID"}),e.jsxs("p",{className:"font-medium font-mono text-xs",children:[l.id.slice(0,8),"..."]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(c,{variant:l.status==="approved"?"default":l.status==="rejected"?"destructive":"secondary",className:l.status==="pending"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":l.status==="under_review"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"","data-testid":"badge-application-status",children:l.status})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Applicant"}),e.jsx("p",{className:"font-medium",children:l.users?.full_name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Submitted"}),e.jsx("p",{className:"font-medium text-sm",children:new Date(l.created_at).toLocaleDateString()})]})]}),l.properties&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Property"}),e.jsx("p",{className:"font-medium",children:l.properties.title}),l.properties.price&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["$",l.properties.price.toLocaleString(),"/mo"]})]}),l.score!==void 0&&l.score!==null&&e.jsxs("div",{className:"border rounded-lg p-4 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"font-medium",children:"Application Score"}),e.jsxs(c,{variant:l.score>=70?"default":l.score>=50?"secondary":"destructive",className:l.score>=70?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"","data-testid":"badge-application-score",children:[l.score,"/100"]})]}),l.score_breakdown&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Income (25 pts)"}),e.jsx("span",{className:"font-medium",children:l.score_breakdown.incomeScore||0})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Credit (25 pts)"}),e.jsx("span",{className:"font-medium",children:l.score_breakdown.creditScore||0})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Rental History (20 pts)"}),e.jsx("span",{className:"font-medium",children:l.score_breakdown.rentalHistoryScore||0})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Employment (15 pts)"}),e.jsx("span",{className:"font-medium",children:l.score_breakdown.employmentScore||0})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Documents (15 pts)"}),e.jsx("span",{className:"font-medium",children:l.score_breakdown.documentsScore||0})]})]}),l.score_breakdown?.factors&&e.jsxs("div",{className:"mt-3 pt-3 border-t space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Key Factors"}),l.score_breakdown.factors.incomeToRentRatio&&e.jsxs("p",{className:"text-xs",children:["Income-to-Rent Ratio: ",l.score_breakdown.factors.incomeToRentRatio.toFixed(1),"x"]}),l.score_breakdown.factors.creditRating&&e.jsxs("p",{className:"text-xs",children:["Credit: ",l.score_breakdown.factors.creditRating]}),l.score_breakdown.factors.employmentStatus&&e.jsxs("p",{className:"text-xs",children:["Employment: ",l.score_breakdown.factors.employmentStatus]})]})]}),l.message&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Message"}),e.jsx("p",{className:"text-sm",children:l.message})]}),(l.status==="pending"||l.status==="under_review")&&e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(r,{onClick:()=>ke(l.id,"approved"),className:"flex-1","data-testid":"button-approve-application",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Approve"]}),e.jsxs(r,{variant:"destructive",onClick:()=>ke(l.id,"rejected"),className:"flex-1","data-testid":"button-reject-application",children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),"Reject"]})]})]})]})}),e.jsx(V,{open:ks,onOpenChange:je,children:e.jsxs(O,{className:"max-w-md",children:[e.jsx(E,{children:e.jsx(H,{children:"Inquiry Details"})}),N&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"From"}),e.jsx("p",{className:"font-medium",children:N.sender_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium",children:N.sender_email})]}),N.sender_phone&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"font-medium",children:N.sender_phone})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Message"}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:N.message})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Received"}),e.jsx("p",{className:"font-medium",children:new Date(N.created_at).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(c,{children:N.status})]}),N.status!=="closed"&&e.jsxs("div",{className:"flex gap-2 pt-4",children:[N.status==="pending"&&e.jsxs(r,{onClick:()=>Be(N.id,"responded"),className:"flex-1","data-testid":"button-respond-inquiry",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Mark Responded"]}),e.jsxs(r,{variant:"outline",onClick:()=>Be(N.id,"closed"),className:"flex-1","data-testid":"button-close-inquiry",children:[e.jsx(Dt,{className:"h-4 w-4 mr-2"}),"Close"]})]})]})]})}),e.jsx(V,{open:Cs,onOpenChange:Oe,children:e.jsxs(O,{className:"max-w-md",children:[e.jsx(E,{children:e.jsx(H,{children:"Saved Search Filters"})}),K&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Search Name"}),e.jsx("p",{className:"font-medium",children:K.name||"Unnamed"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Created By"}),e.jsx("p",{className:"font-medium",children:K.users?.full_name||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Filters Applied"}),K.filters?e.jsx("div",{className:"bg-muted p-3 rounded-md mt-2",children:e.jsx("pre",{className:"text-xs overflow-auto",children:JSON.stringify(K.filters,null,2)})}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No filters saved"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Created"}),e.jsx("p",{className:"font-medium",children:new Date(K.created_at).toLocaleString()})]})]})]})}),e.jsx(Tt,{open:!!F,onOpenChange:()=>z(null),children:e.jsxs(Mt,{children:[e.jsxs(zt,{children:[e.jsx(Vt,{children:"Confirm Delete"}),e.jsxs(Ot,{children:['Are you sure you want to delete "',F?.name,'"? This action cannot be undone.']})]}),e.jsxs(Et,{children:[e.jsx(Ht,{"data-testid":"button-cancel-delete",children:"Cancel"}),e.jsx(Bt,{onClick:()=>{F?.type==="property"?Ks(F.id):F?.type==="user"?Ys(F.id):F?.type==="search"&&Gs(F.id)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90","data-testid":"button-confirm-delete",children:"Delete"})]})]})})]})}export{Ia as default};
