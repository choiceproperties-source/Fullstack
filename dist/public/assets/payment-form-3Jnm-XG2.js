import{r as t,j as e}from"./ui-DbSH5uIw.js";import{ad as O,aa as $e,ax as m,L as B,A as Re,C as Be,F as Ze,G as Oe,t as D,o as qe,v as E,H as Ue,l as _e,ai as We,c as x,af as oe,X as p,I as g,E as Ge,q as Je,P as xe,B as w,w as me,R as Xe,D as he,d as ue,J as pe,e as fe,f as ge,k as je,r as Qe}from"./index-C3yA2dmm.js";import{C as Ke}from"./checkbox-DOjwYwUo.js";import{E as es}from"./eye-off-Bubmbnfp.js";const ss=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ne=O("circle-question-mark",ss);const ts=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Z=O("credit-card",ts);const as=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],rs=O("fingerprint",as),I={visa:/^4/,mastercard:/^5[1-5]/,amex:/^3[47]/,discover:/^6(?:011|5)/},ns=c=>{const l=c.replace(/\s/g,"");return I.visa.test(l)?"visa":I.mastercard.test(l)?"mastercard":I.amex.test(l)?"amex":I.discover.test(l)?"discover":"unknown"},is=c=>{const l=c.replace(/\s+/g,"").replace(/[^0-9]/gi,""),j=l.match(/\d{4,16}/g),N=j&&j[0]||"",f=[];for(let h=0,S=N.length;h<S;h+=4)f.push(N.substring(h,h+4));return f.length?f.join(" "):l},ls=c=>{const l=c.replace(/\s+/g,"").replace(/[^0-9]/gi,"");return l.length>=2?l.substring(0,2)+"/"+l.substring(2,4):l},be=["Your card was declined. Please try a different payment method or contact your bank.","Transaction declined: Insufficient funds. Please use a different card.","Card declined: The card issuer has blocked this transaction. Please contact your bank.","Payment failed: This card cannot be used for this type of transaction.","Security alert: This transaction was flagged for review. Please contact your card issuer.","Transaction declined: Card verification failed. Please verify your card details.","Payment declined: Your card's daily limit has been reached.","Transaction failed: Unable to authorize payment. Please try again or use a different card."],k=[{label:"Validating card details...",icon:Z},{label:"Connecting to secure payment gateway...",icon:$e},{label:"Initiating 3D Secure authentication...",icon:m},{label:"Verifying with card issuer...",icon:rs},{label:"Processing transaction...",icon:B},{label:"Finalizing payment...",icon:Re}];function ms({amount:c,onSuccess:l,onError:j,onContactSupport:N,applicationId:f,propertyAddress:h,sessionTimeoutMinutes:S=15}){const[P,q]=t.useState(""),[U,_]=t.useState(""),[W,G]=t.useState(""),[J,X]=t.useState(""),[Q,K]=t.useState(""),[ve,ye]=t.useState(!1),[o,L]=t.useState(!1),[b,F]=t.useState(0),[ee,u]=t.useState(null),[v,Ce]=t.useState("unknown"),[a,se]=t.useState({}),[T,we]=t.useState([]),[ke,z]=t.useState(!1),[M,Se]=t.useState(null),[A,Pe]=t.useState(!1),[H,te]=t.useState(S*60),[d,ae]=t.useState(!1),[Le,y]=t.useState(!1),[V,re]=t.useState(""),[Y,$]=t.useState("");t.useEffect(()=>{if(d)return;const s=setInterval(()=>{te(n=>n<=1?(ae(!0),0):n-1)},1e3);return()=>clearInterval(s)},[d]);const Fe=s=>{const n=Math.floor(s/60),r=s%60;return`${n}:${r.toString().padStart(2,"0")}`},R=()=>H<=60?"critical":H<=180?"warning":"normal";t.useEffect(()=>{Ce(ns(P))},[P]);const Me=()=>{const s={},n=P.replace(/\s/g,"");(n.length<15||n.length>16)&&(s.cardNumber="Please enter a valid card number"),U.length<3&&(s.cardName="Please enter the name on your card");const r=W.split("/");if(r.length!==2||r[0].length!==2||r[1].length!==2)s.expiry="Please enter a valid expiry date (MM/YY)";else{const C=parseInt(r[0]),le=parseInt("20"+r[1]),ce=new Date,de=ce.getFullYear(),Ye=ce.getMonth()+1;C<1||C>12?s.expiry="Invalid month":(le<de||le===de&&C<Ye)&&(s.expiry="This card has expired")}const i=v==="amex"?4:3;return J.length!==i&&(s.cvv=`Please enter a valid ${i}-digit security code`),Q.length<5&&(s.zipCode="Please enter a valid ZIP code"),se(s),Object.keys(s).length===0},ne=()=>`PAY-${Date.now().toString(36).toUpperCase()}-${Math.random().toString(36).substring(2,8).toUpperCase()}`,De=async()=>{if(V.length!==6){$("Please enter the 6-digit verification code");return}$(""),y(!1),await Ee()},Ee=async()=>{for(let i=4;i<k.length;i++)F(i),await new Promise(C=>setTimeout(C,800+Math.random()*600));await new Promise(i=>setTimeout(i,500));const s=be[Math.floor(Math.random()*be.length)],n=M||ne(),r={referenceId:n,timestamp:new Date().toISOString(),status:"failed",amount:c,errorMessage:s};if(we(i=>[...i,r]),f)try{await Qe("POST",`/api/applications/${f}/payment-attempt`,{referenceId:n,status:"failed",amount:c,errorMessage:s})}catch(i){console.error("Failed to save payment attempt to database:",i)}u(s),L(!1),j&&j(s)},ie=async s=>{if(s.preventDefault(),u(null),d){u("Your payment session has expired. Please refresh the page to start a new session.");return}if(!Me())return;L(!0),F(0);const n=ne();Se(n);for(let r=0;r<3;r++)F(r),await new Promise(i=>setTimeout(i,800+Math.random()*600));F(3),await new Promise(r=>setTimeout(r,500)),L(!1),re(""),$(""),y(!0)},Ie=()=>{u(null),ie(new Event("submit"))},Te=()=>{u(null),q(""),_(""),G(""),X(""),K(""),se({})},ze=()=>{z(!0),N&&N()},Ae=()=>{te(S*60),ae(!1),u(null)},He=()=>{const s="h-8 w-auto";switch(v){case"visa":return e.jsxs("svg",{className:s,viewBox:"0 0 50 35",fill:"none",children:[e.jsx("rect",{width:"50",height:"35",rx:"4",fill:"#1A1F71"}),e.jsx("path",{d:"M19.5 22.5L21.5 12.5H24L22 22.5H19.5Z",fill:"white"}),e.jsx("path",{d:"M30.5 12.7C29.9 12.5 29 12.3 27.9 12.3C25 12.3 23 13.8 23 15.9C23 17.4 24.3 18.2 25.3 18.7C26.3 19.2 26.7 19.5 26.7 20C26.7 20.7 25.9 21 25.1 21C24 21 23.4 20.8 22.5 20.4L22.1 20.2L21.7 23C22.5 23.4 23.9 23.7 25.3 23.7C28.4 23.7 30.3 22.2 30.3 20C30.3 18.8 29.6 17.9 28 17.1C27.1 16.6 26.5 16.3 26.5 15.7C26.5 15.2 27.1 14.7 28.2 14.7C29.1 14.7 29.8 14.9 30.3 15.1L30.6 15.2L31 12.8L30.5 12.7Z",fill:"white"}),e.jsx("path",{d:"M35.5 12.5H33.5C32.8 12.5 32.3 12.7 32 13.4L27.5 22.5H30.6L31.2 20.8H35L35.3 22.5H38L35.5 12.5ZM32.2 18.5C32.4 17.9 33.5 15.1 33.5 15.1C33.5 15.1 33.8 14.3 34 13.8L34.2 15L35 18.5H32.2Z",fill:"white"}),e.jsx("path",{d:"M17.5 12.5L14.6 19.3L14.3 17.8C13.7 16 12 14.1 10 13.1L12.6 22.5H15.8L20.8 12.5H17.5Z",fill:"white"}),e.jsx("path",{d:"M12.5 12.5H7.5L7.5 12.7C11.2 13.6 13.6 15.8 14.4 18.3L13.5 13.4C13.4 12.8 12.9 12.5 12.5 12.5Z",fill:"#F9A51A"})]});case"mastercard":return e.jsxs("svg",{className:s,viewBox:"0 0 50 35",fill:"none",children:[e.jsx("rect",{width:"50",height:"35",rx:"4",fill:"#000"}),e.jsx("circle",{cx:"20",cy:"17.5",r:"8",fill:"#EB001B"}),e.jsx("circle",{cx:"30",cy:"17.5",r:"8",fill:"#F79E1B"}),e.jsx("path",{d:"M25 11.5C26.8 12.9 28 15.1 28 17.5C28 19.9 26.8 22.1 25 23.5C23.2 22.1 22 19.9 22 17.5C22 15.1 23.2 12.9 25 11.5Z",fill:"#FF5F00"})]});case"amex":return e.jsxs("svg",{className:s,viewBox:"0 0 50 35",fill:"none",children:[e.jsx("rect",{width:"50",height:"35",rx:"4",fill:"#006FCF"}),e.jsx("path",{d:"M8 17L10 12H14L16 17L14 22H10L8 17Z",fill:"white"}),e.jsx("text",{x:"25",y:"20",fill:"white",fontSize:"8",fontWeight:"bold",textAnchor:"middle",children:"AMEX"})]});case"discover":return e.jsxs("svg",{className:s,viewBox:"0 0 50 35",fill:"none",children:[e.jsx("rect",{width:"50",height:"35",rx:"4",fill:"#FF6600"}),e.jsx("circle",{cx:"32",cy:"17.5",r:"6",fill:"#FFF"}),e.jsx("text",{x:"18",y:"20",fill:"white",fontSize:"7",fontWeight:"bold",children:"DISCOVER"})]});default:return e.jsx(Z,{className:"h-6 w-6 text-muted-foreground"})}},Ve=k[b]?.icon||B;return e.jsxs(e.Fragment,{children:[e.jsxs(Be,{className:"w-full max-w-lg mx-auto",children:[e.jsxs(Ze,{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 pb-3 border-b mb-3",children:[e.jsx(m,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"text-sm font-semibold text-muted-foreground",children:"Secure Payment Gateway"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(Oe,{className:"text-xl",children:"Secure Payment"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:D("flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium",R()==="critical"&&"bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 animate-pulse",R()==="warning"&&"bg-amber-100 dark:bg-amber-900 text-amber-700 dark:text-amber-300",R()==="normal"&&"bg-muted text-muted-foreground"),children:[e.jsx(qe,{className:"h-3 w-3"}),e.jsx("span",{children:Fe(H)})]}),e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-medium",children:"SSL"})]})]})]}),e.jsx(Ue,{children:h?`Application fee for ${h}`:"Complete your secure payment"})]}),e.jsxs("form",{onSubmit:ie,children:[e.jsxs(_e,{className:"space-y-4",children:[d&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-950 border border-amber-200 dark:border-amber-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(We,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-amber-900 dark:text-amber-100",children:"Session Expired"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300 mt-1",children:"Your secure payment session has expired for security reasons."}),e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:Ae,className:"mt-2","data-testid":"button-refresh-session",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Start New Session"]})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 rounded-lg p-4 border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Application Fee"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:"One-time payment"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"text-2xl font-bold",children:["$",c.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"USD"})]})]})}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-950 rounded-md",children:[e.jsx(m,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-xs text-blue-700 dark:text-blue-300",children:"Protected by advanced fraud detection and 3D Secure 2.0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"cardNumber",children:"Card Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"cardNumber","data-testid":"input-card-number",placeholder:"1234 5678 9012 3456",value:P,onChange:s=>q(is(s.target.value)),maxLength:19,className:D("pr-16",a.cardNumber&&"border-red-500"),disabled:o||d}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(He,{})})]}),a.cardNumber&&e.jsx("p",{className:"text-xs text-red-500",children:a.cardNumber})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"cardName",children:"Name on Card"}),e.jsx(g,{id:"cardName","data-testid":"input-card-name",placeholder:"JOHN DOE",value:U,onChange:s=>_(s.target.value.toUpperCase()),className:a.cardName?"border-red-500":"",disabled:o||d}),a.cardName&&e.jsx("p",{className:"text-xs text-red-500",children:a.cardName})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"expiry",children:"Expiry Date"}),e.jsx(g,{id:"expiry","data-testid":"input-expiry",placeholder:"MM/YY",value:W,onChange:s=>G(ls(s.target.value)),maxLength:5,className:a.expiry?"border-red-500":"",disabled:o||d}),a.expiry&&e.jsx("p",{className:"text-xs text-red-500",children:a.expiry})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"cvv",children:"CVV"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"cvv","data-testid":"input-cvv",placeholder:v==="amex"?"1234":"123",value:J,onChange:s=>X(s.target.value.replace(/\D/g,"").slice(0,v==="amex"?4:3)),maxLength:v==="amex"?4:3,type:A?"text":"password",className:D("pr-8",a.cvv&&"border-red-500"),disabled:o||d}),e.jsx("button",{type:"button",onClick:()=>Pe(!A),className:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",tabIndex:-1,children:A?e.jsx(es,{className:"h-4 w-4"}):e.jsx(Ge,{className:"h-4 w-4"})})]}),a.cvv&&e.jsx("p",{className:"text-xs text-red-500",children:a.cvv})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"zipCode",children:"ZIP Code"}),e.jsx(g,{id:"zipCode","data-testid":"input-zip-code",placeholder:"12345",value:Q,onChange:s=>K(s.target.value.replace(/\D/g,"").slice(0,5)),maxLength:5,className:a.zipCode?"border-red-500":"",disabled:o||d}),a.zipCode&&e.jsx("p",{className:"text-xs text-red-500",children:a.zipCode})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ke,{id:"saveCard","data-testid":"checkbox-save-card",checked:ve,onCheckedChange:s=>ye(s),disabled:o||d}),e.jsx(p,{htmlFor:"saveCard",className:"text-sm text-muted-foreground cursor-pointer",children:"Save this card for future transactions"})]}),o&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"relative",children:e.jsx(Ve,{className:"h-6 w-6 animate-spin text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:k[b].label}),e.jsx("div",{className:"mt-2 h-2 bg-blue-200 dark:bg-blue-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 transition-all duration-500",style:{width:`${(b+1)/k.length*100}%`}})}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:["Step ",b+1," of ",k.length]})]})]}),b>=2&&e.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200 dark:border-blue-700",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-700 dark:text-blue-300",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx("span",{children:"Your bank may request additional verification"})]})})]}),ee&&e.jsx("div",{className:"bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Je,{className:"h-5 w-5 text-red-600 shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-red-900 dark:text-red-100",children:"Payment couldn't be completed right now"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:"No charges were made. Please try again later."}),e.jsxs("div",{className:"mt-2 p-2 bg-red-100 dark:bg-red-900 rounded text-xs space-y-1",children:[e.jsxs("p",{className:"text-red-800 dark:text-red-200",children:[e.jsx("span",{className:"font-medium",children:"Reference ID:"})," ",M]}),e.jsxs("p",{className:"text-red-800 dark:text-red-200",children:[e.jsx("span",{className:"font-medium",children:"Timestamp:"})," ",new Date().toLocaleString()]}),e.jsxs("p",{className:"text-red-800 dark:text-red-200",children:[e.jsx("span",{className:"font-medium",children:"Amount:"})," $",c.toFixed(2)]}),e.jsxs("p",{className:"text-red-800 dark:text-red-200",children:[e.jsx("span",{className:"font-medium",children:"Status:"})," Failed"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:Ie,"data-testid":"button-retry-payment",className:"flex items-center gap-1",children:[e.jsx(oe,{className:"h-3 w-3"}),"Retry Payment"]}),e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:Te,"data-testid":"button-try-new-card",className:"flex items-center gap-1",children:[e.jsx(Z,{className:"h-3 w-3"}),"Try New Card"]}),e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:ze,"data-testid":"button-contact-support",className:"flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),"Contact Support"]})]})]})]})}),T.length>0&&!ee&&e.jsxs("div",{className:"bg-muted/30 rounded-lg p-3",children:[e.jsxs("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:["Previous Attempts (",T.length,")"]}),e.jsx("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:T.slice(-3).map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:s.referenceId}),e.jsx(w,{variant:"destructive",className:"text-xs",children:"Failed"})]},n))})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{children:"Your payment is secured with 256-bit SSL encryption"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{children:"We never store your full card details"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx("span",{children:"PCI-DSS Level 1 compliant payment processing"})]})]})]}),e.jsxs(Xe,{className:"flex flex-col gap-3",children:[e.jsx(x,{type:"submit","data-testid":"button-submit-payment",className:"w-full",size:"lg",disabled:o||d,children:o?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Pay $",c.toFixed(2)]})}),e.jsxs("div",{className:"flex items-center justify-center gap-2 w-full",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Accepted Cards:"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(w,{variant:"outline",className:"text-xs px-1.5",children:"Visa"}),e.jsx(w,{variant:"outline",className:"text-xs px-1.5",children:"Mastercard"}),e.jsx(w,{variant:"outline",className:"text-xs px-1.5",children:"Amex"}),e.jsx(w,{variant:"outline",className:"text-xs px-1.5",children:"Discover"})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 pt-2 border-t w-full",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(m,{className:"h-3 w-3"}),e.jsx("span",{children:"Verified"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(E,{className:"h-3 w-3"}),e.jsx("span",{children:"Secure"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(me,{className:"h-3 w-3"}),e.jsx("span",{children:"Protected"})]})]})]})]})]}),e.jsx(he,{open:Le,onOpenChange:y,children:e.jsxs(ue,{className:"sm:max-w-md",children:[e.jsxs(pe,{children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-full",children:e.jsx(m,{className:"h-8 w-8 text-blue-600"})})}),e.jsx(fe,{className:"text-center",children:"3D Secure Verification"}),e.jsx(ge,{className:"text-center",children:"Your bank requires additional verification. Please enter the code sent to your registered phone/email."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Verifying payment of"}),e.jsxs("p",{className:"text-xl font-bold",children:["$",c.toFixed(2)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"secureCode",children:"Verification Code"}),e.jsx(g,{id:"secureCode","data-testid":"input-3ds-code",placeholder:"Enter 6-digit code",value:V,onChange:s=>re(s.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:D("text-center text-lg tracking-widest",Y&&"border-red-500")}),Y&&e.jsx("p",{className:"text-xs text-red-500 text-center",children:Y})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Didn't receive a code? Check your spam folder or contact your bank."})]}),e.jsxs(je,{className:"flex-col sm:flex-row gap-2",children:[e.jsx(x,{variant:"outline",onClick:()=>{y(!1),u("Verification cancelled by user")},"data-testid":"button-cancel-3ds",children:"Cancel"}),e.jsxs(x,{onClick:()=>{L(!0),y(!1),De()},disabled:V.length!==6,"data-testid":"button-verify-3ds",children:[e.jsx(m,{className:"mr-2 h-4 w-4"}),"Verify & Pay"]})]})]})}),e.jsx(he,{open:ke,onOpenChange:z,children:e.jsxs(ue,{children:[e.jsxs(pe,{children:[e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-primary"}),"Contact Support"]}),e.jsx(ge,{children:"We're here to help with your payment issues."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-muted rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Phone Support"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"1-800-555-0199"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mon-Fri, 9AM-6PM EST"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ne,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Email Support"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"support@choiceproperties.com"})]})]})]}),M&&e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-950 border border-amber-200 dark:border-amber-800 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-amber-800 dark:text-amber-200",children:e.jsx("span",{className:"font-medium",children:"Reference ID for support:"})}),e.jsx("p",{className:"text-sm font-mono text-amber-900 dark:text-amber-100 mt-1",children:M})]})]}),e.jsx(je,{children:e.jsx(x,{variant:"outline",onClick:()=>z(!1),children:"Close"})})]})})]})}export{Z as C,ms as P};
