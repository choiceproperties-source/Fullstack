import{r,j as e}from"./ui-DbSH5uIw.js";import{ad as P,y as R,u as _,a as I,z as T,N as h,C as p,n as l,Y as y,c as n,V as M,K as j,M as Y,af as c,o as F,ae as g}from"./index-C3yA2dmm.js";import{m as s}from"./proxy-BJuH2pIT.js";import{A as L}from"./index-BQMeD4bJ.js";import"./vendor-15WF5uYg.js";import"./query-C11-Me4M.js";import"./charts-DfbWf95P.js";const H=[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]],z=P("inbox",H);function G(){r.useEffect(()=>{R({title:"Verify Email - Choice Properties",description:"Please verify your email address to continue using Choice Properties.",image:"https://choiceproperties.com/og-image.png",url:"https://choiceproperties.com/verify-email"})},[]);const{user:v,resendVerificationEmail:N,logout:b,isEmailVerified:w}=_(),{toast:i}=I(),[o,d]=r.useState(!1),[k,C]=r.useState(!1),[t,m]=r.useState(0),[x,u]=r.useState(!1),E=v?.email||localStorage.getItem("pending_verification_email")||"your email address";r.useEffect(()=>{if(t>0){const a=setTimeout(()=>m(t-1),1e3);return()=>clearTimeout(a)}},[t]);const S=async()=>{if(!(t>0)){d(!0);try{await N(),C(!0),m(60),i({title:"Email sent!",description:"A new verification email has been sent to your inbox."})}catch(a){i({title:"Failed to send email",description:a.message||"Please try again later.",variant:"destructive"})}finally{d(!1)}}},[,A]=T(),V=async()=>{u(!0);try{if(!g){i({title:"Service unavailable",description:"Authentication service is not available. Please try again later.",variant:"destructive"});return}const{data:{session:a},error:f}=await g.auth.getSession();if(f){console.error("[Verify Email] Error checking status:",f),i({title:"Error checking status",description:"Could not verify your status. Please try again.",variant:"destructive"});return}a?.user?.email_confirmed_at?(localStorage.removeItem("pending_verification_email"),i({title:"Email verified!",description:"Your email has been verified successfully."}),setTimeout(()=>{A("/")},1e3)):i({title:"Not verified yet",description:"Please check your email and click the verification link, then try again."})}catch(a){console.error("[Verify Email] Unexpected error:",a),i({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{u(!1)}};return w?e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(h,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4 bg-gradient-to-br from-primary/5 via-background to-secondary/5",children:e.jsx(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.4},children:e.jsxs(p,{className:"max-w-md w-full p-8 shadow-xl text-center border-t-4 border-t-green-500",children:[e.jsx(s.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},children:e.jsx("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(l,{className:"h-10 w-10 text-green-500"})})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Email Verified!"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Your email has been verified successfully. You can now access all features."}),e.jsx(y,{href:"/",children:e.jsxs(n,{className:"w-full","data-testid":"button-continue",children:["Continue to Home ",e.jsx(M,{className:"ml-2 h-4 w-4"})]})})]})})}),e.jsx(j,{})]}):e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(h,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4 bg-gradient-to-br from-primary/5 via-background to-secondary/5",children:e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"w-full max-w-md",children:[e.jsxs(p,{className:"w-full p-8 shadow-xl border-t-4 border-t-primary",children:[e.jsx("div",{className:"text-center mb-6",children:e.jsxs(s.div,{initial:{scale:.9},animate:{scale:1},transition:{duration:.3,delay:.1},children:[e.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Y,{className:"h-8 w-8 text-primary"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Check Your Inbox"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"We've sent a verification link to"})]})}),e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"bg-muted/50 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"font-medium text-center text-foreground break-all",children:E})}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-start gap-3 text-sm",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-xs font-bold text-primary",children:"1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Open your email"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Check your inbox for an email from us"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 text-sm",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-xs font-bold text-primary",children:"2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Click the verification link"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"The link will verify your email instantly"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 text-sm",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-xs font-bold text-primary",children:"3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Start exploring"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Access all features after verification"})]})]})]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-3 mb-6",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-400",children:"Don't see the email? Check your spam or junk folder. Sometimes verification emails end up there."})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{onClick:V,disabled:x,className:"w-full","data-testid":"button-check-status",children:x?e.jsxs(e.Fragment,{children:[e.jsx(c,{className:"mr-2 h-4 w-4 animate-spin"}),"Checking..."]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{className:"mr-2 h-4 w-4"}),"I've Verified My Email"]})}),e.jsx(n,{onClick:S,disabled:o||t>0,variant:"outline",className:"w-full","data-testid":"button-resend-verification",children:e.jsx(L,{mode:"wait",children:o?e.jsxs(s.span,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center",children:[e.jsx(c,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]},"sending"):t>0?e.jsxs(s.span,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"Resend in ",t,"s"]},"countdown"):e.jsxs(s.span,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex items-center",children:[e.jsx(c,{className:"mr-2 h-4 w-4"}),"Resend Verification Email"]},"resend")})}),e.jsx(n,{onClick:b,variant:"ghost",className:"w-full text-muted-foreground","data-testid":"button-logout",children:"Use a different email address"})]}),k&&t>0&&e.jsx(s.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-4",children:e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(l,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-green-700 dark:text-green-400",children:"A new verification email has been sent! Check your inbox."})]})})})]}),e.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-4",children:["Having trouble?"," ",e.jsx(y,{href:"/contact",children:e.jsx("span",{className:"text-primary hover:underline cursor-pointer",children:"Contact support"})})]})]})}),e.jsx(j,{})]})}export{G as default};
